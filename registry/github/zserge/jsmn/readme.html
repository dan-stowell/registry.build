<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><div class="markdown-heading" dir="auto"><h1 class="heading-element" dir="auto">JSMN</h1><a id="user-content-jsmn" class="anchor" aria-label="Permalink: JSMN" href="#jsmn"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="https://travis-ci.org/zserge/jsmn" rel="nofollow"><img src="https://camo.githubusercontent.com/3335e6469613d37cc9efbf4a4b7cc868ed7117c38ef9dbdad6e70de21ff5082f/68747470733a2f2f7472617669732d63692e6f72672f7a73657267652f6a736d6e2e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/zserge/jsmn.svg?branch=master" style="max-width: 100%; height: auto;"></a></p>
<p dir="auto">jsmn (pronounced like 'jasmine') is a minimalistic JSON parser in C.  It can be
easily integrated into resource-limited or embedded projects.</p>
<p dir="auto">You can find more information about JSON format at <a href="http://www.json.org/" rel="nofollow">json.org</a></p>
<p dir="auto">Library sources are available at <a href="https://github.com/zserge/jsmn">https://github.com/zserge/jsmn</a></p>
<p dir="auto">The web page with some information about jsmn can be found at
<a href="http://zserge.com/jsmn.html" rel="nofollow">http://zserge.com/jsmn.html</a></p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Philosophy</h2><a id="user-content-philosophy" class="anchor" aria-label="Permalink: Philosophy" href="#philosophy"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Most JSON parsers offer you a bunch of functions to load JSON data, parse it
and extract any value by its name. jsmn proves that checking the correctness of
every JSON packet or allocating temporary objects to store parsed JSON fields
often is an overkill.</p>
<p dir="auto">JSON format itself is extremely simple, so why should we complicate it?</p>
<p dir="auto">jsmn is designed to be	<strong>robust</strong> (it should work fine even with erroneous
data), <strong>fast</strong> (it should parse data on the fly), <strong>portable</strong> (no superfluous
dependencies or non-standard C extensions). And of course, <strong>simplicity</strong> is a
key feature - simple code style, simple algorithm, simple integration into
other projects.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Features</h2><a id="user-content-features" class="anchor" aria-label="Permalink: Features" href="#features"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>compatible with C89</li>
<li>no dependencies (even libc!)</li>
<li>highly portable (tested on x86/amd64, ARM, AVR)</li>
<li>about 200 lines of code</li>
<li>extremely small code footprint</li>
<li>API contains only 2 functions</li>
<li>no dynamic memory allocation</li>
<li>incremental single-pass parsing</li>
<li>library code is covered with unit-tests</li>
</ul>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Design</h2><a id="user-content-design" class="anchor" aria-label="Permalink: Design" href="#design"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The rudimentary jsmn object is a <strong>token</strong>. Let's consider a JSON string:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="'{ &quot;name&quot; : &quot;Jack&quot;, &quot;age&quot; : 27 }'"><pre class="notranslate"><code>'{ "name" : "Jack", "age" : 27 }'
</code></pre></div>
<p dir="auto">It holds the following tokens:</p>
<ul dir="auto">
<li>Object: <code>{ "name" : "Jack", "age" : 27}</code> (the whole object)</li>
<li>Strings: <code>"name"</code>, <code>"Jack"</code>, <code>"age"</code> (keys and some values)</li>
<li>Number: <code>27</code></li>
</ul>
<p dir="auto">In jsmn, tokens do not hold any data, but point to token boundaries in JSON
string instead. In the example above jsmn will create tokens like: Object
[0..31], String [3..7], String [12..16], String [20..23], Number [27..29].</p>
<p dir="auto">Every jsmn token has a type, which indicates the type of corresponding JSON
token. jsmn supports the following token types:</p>
<ul dir="auto">
<li>Object - a container of key-value pairs, e.g.:
<code>{ "foo":"bar", "x":0.3 }</code></li>
<li>Array - a sequence of values, e.g.:
<code>[ 1, 2, 3 ]</code></li>
<li>String - a quoted sequence of chars, e.g.: <code>"foo"</code></li>
<li>Primitive - a number, a boolean (<code>true</code>, <code>false</code>) or <code>null</code></li>
</ul>
<p dir="auto">Besides start/end positions, jsmn tokens for complex types (like arrays
or objects) also contain a number of child items, so you can easily follow
object hierarchy.</p>
<p dir="auto">This approach provides enough information for parsing any JSON data and makes
it possible to use zero-copy techniques.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Usage</h2><a id="user-content-usage" class="anchor" aria-label="Permalink: Usage" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Download <code>jsmn.h</code>, include it, done.</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="#include &quot;jsmn.h&quot;

...
jsmn_parser p;
jsmntok_t t[128]; /* We expect no more than 128 JSON tokens */

jsmn_init(&amp;p);
r = jsmn_parse(&amp;p, s, strlen(s), t, 128); // &quot;s&quot; is the char array holding the json content"><pre class="notranslate"><code>#include "jsmn.h"

...
jsmn_parser p;
jsmntok_t t[128]; /* We expect no more than 128 JSON tokens */

jsmn_init(&amp;p);
r = jsmn_parse(&amp;p, s, strlen(s), t, 128); // "s" is the char array holding the json content
</code></pre></div>
<p dir="auto">Since jsmn is a single-header, header-only library, for more complex use cases
you might need to define additional macros. <code>#define JSMN_STATIC</code> hides all
jsmn API symbols by making them static. Also, if you want to include <code>jsmn.h</code>
from multiple C files, to avoid duplication of symbols you may define  <code>JSMN_HEADER</code> macro.</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="/* In every .c file that uses jsmn include only declarations: */
#define JSMN_HEADER
#include &quot;jsmn.h&quot;

/* Additionally, create one jsmn.c file for jsmn implementation: */
#include &quot;jsmn.h&quot;"><pre class="notranslate"><code>/* In every .c file that uses jsmn include only declarations: */
#define JSMN_HEADER
#include "jsmn.h"

/* Additionally, create one jsmn.c file for jsmn implementation: */
#include "jsmn.h"
</code></pre></div>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">API</h2><a id="user-content-api" class="anchor" aria-label="Permalink: API" href="#api"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Token types are described by <code>jsmntype_t</code>:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="typedef enum {
	JSMN_UNDEFINED = 0,
	JSMN_OBJECT = 1 &lt;&lt; 0,
	JSMN_ARRAY = 1 &lt;&lt; 1,
	JSMN_STRING = 1 &lt;&lt; 2,
	JSMN_PRIMITIVE = 1 &lt;&lt; 3
} jsmntype_t;"><pre class="notranslate"><code>typedef enum {
	JSMN_UNDEFINED = 0,
	JSMN_OBJECT = 1 &lt;&lt; 0,
	JSMN_ARRAY = 1 &lt;&lt; 1,
	JSMN_STRING = 1 &lt;&lt; 2,
	JSMN_PRIMITIVE = 1 &lt;&lt; 3
} jsmntype_t;
</code></pre></div>
<p dir="auto"><strong>Note:</strong> Unlike JSON data types, primitive tokens are not divided into
numbers, booleans and null, because one can easily tell the type using the
first character:</p>
<ul dir="auto">
<li><code>'t', 'f'</code> - boolean</li>
<li><code>'n'</code> - null</li>
<li><code>'-', '0'..'9'</code> - number</li>
</ul>
<p dir="auto">Token is an object of <code>jsmntok_t</code> type:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="typedef struct {
	jsmntype_t type; // Token type
	int start;       // Token start position
	int end;         // Token end position
	int size;        // Number of child (nested) tokens
} jsmntok_t;"><pre class="notranslate"><code>typedef struct {
	jsmntype_t type; // Token type
	int start;       // Token start position
	int end;         // Token end position
	int size;        // Number of child (nested) tokens
} jsmntok_t;
</code></pre></div>
<p dir="auto"><strong>Note:</strong> string tokens point to the first character after
the opening quote and the previous symbol before final quote. This was made
to simplify string extraction from JSON data.</p>
<p dir="auto">All job is done by <code>jsmn_parser</code> object. You can initialize a new parser using:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="jsmn_parser parser;
jsmntok_t tokens[10];

jsmn_init(&amp;parser);

// js - pointer to JSON string
// tokens - an array of tokens available
// 10 - number of tokens available
jsmn_parse(&amp;parser, js, strlen(js), tokens, 10);"><pre class="notranslate"><code>jsmn_parser parser;
jsmntok_t tokens[10];

jsmn_init(&amp;parser);

// js - pointer to JSON string
// tokens - an array of tokens available
// 10 - number of tokens available
jsmn_parse(&amp;parser, js, strlen(js), tokens, 10);
</code></pre></div>
<p dir="auto">This will create a parser, and then it tries to parse up to 10 JSON tokens from
the <code>js</code> string.</p>
<p dir="auto">A non-negative return value of <code>jsmn_parse</code> is the number of tokens actually
used by the parser.
Passing NULL instead of the tokens array would not store parsing results, but
instead the function will return the number of tokens needed to parse the given
string. This can be useful if you don't know yet how many tokens to allocate.</p>
<p dir="auto">If something goes wrong, you will get an error. Error will be one of these:</p>
<ul dir="auto">
<li><code>JSMN_ERROR_INVAL</code> - bad token, JSON string is corrupted</li>
<li><code>JSMN_ERROR_NOMEM</code> - not enough tokens, JSON string is too large</li>
<li><code>JSMN_ERROR_PART</code> - JSON string is too short, expecting more JSON data</li>
</ul>
<p dir="auto">If you get <code>JSMN_ERROR_NOMEM</code>, you can re-allocate more tokens and call
<code>jsmn_parse</code> once more.  If you read json data from the stream, you can
periodically call <code>jsmn_parse</code> and check if return value is <code>JSMN_ERROR_PART</code>.
You will get this error until you reach the end of JSON data.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Other info</h2><a id="user-content-other-info" class="anchor" aria-label="Permalink: Other info" href="#other-info"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">This software is distributed under <a href="http://www.opensource.org/licenses/mit-license.php" rel="nofollow">MIT license</a>,
so feel free to integrate it in your commercial products.</p>
</article></div>