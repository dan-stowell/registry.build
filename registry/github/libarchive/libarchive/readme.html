<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><div class="markdown-heading" dir="auto"><h1 class="heading-element" dir="auto">Welcome to libarchive!</h1><a id="user-content-welcome-to-libarchive" class="anchor" aria-label="Permalink: Welcome to libarchive!" href="#welcome-to-libarchive"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The libarchive project develops a portable, efficient C library that
can read and write streaming archives in a variety of formats.  It
also includes implementations of the common <code>tar</code>, <code>cpio</code>, and <code>zcat</code>
command-line tools that use the libarchive library.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Questions?  Issues?</h2><a id="user-content-questions--issues" class="anchor" aria-label="Permalink: Questions?  Issues?" href="#questions--issues"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><a href="https://www.libarchive.org" rel="nofollow">https://www.libarchive.org</a> is the home for ongoing
libarchive development, including documentation,
and links to the libarchive mailing lists.</li>
<li>To report an issue, use the issue tracker at
<a href="https://github.com/libarchive/libarchive/issues">https://github.com/libarchive/libarchive/issues</a></li>
<li>To submit an enhancement to libarchive, please
submit a pull request via GitHub: <a href="https://github.com/libarchive/libarchive/pulls">https://github.com/libarchive/libarchive/pulls</a></li>
</ul>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Contents of the Distribution</h2><a id="user-content-contents-of-the-distribution" class="anchor" aria-label="Permalink: Contents of the Distribution" href="#contents-of-the-distribution"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">This distribution bundle includes the following major components:</p>
<ul dir="auto">
<li><strong>libarchive</strong>: a library for reading and writing streaming archives</li>
<li><strong>tar</strong>: the 'bsdtar' program is a full-featured 'tar' implementation built on libarchive</li>
<li><strong>cpio</strong>: the 'bsdcpio' program is a different interface to essentially the same functionality</li>
<li><strong>cat</strong>: the 'bsdcat' program is a simple replacement tool for zcat, bzcat, xzcat, and such</li>
<li><strong>unzip</strong>: the 'bsdunzip' program is a simple replacement tool for Info-ZIP's unzip</li>
<li><strong>examples</strong>: Some small example programs that you may find useful.</li>
<li><strong>examples/minitar</strong>: a compact sample demonstrating use of libarchive.</li>
<li><strong>contrib</strong>:  Various items sent to me by third parties; please contact the authors with any questions.</li>
</ul>
<p dir="auto">The top-level directory contains the following information files:</p>
<ul dir="auto">
<li><strong>NEWS</strong> - highlights of recent changes</li>
<li><strong>COPYING</strong> - what you can do with this</li>
<li><strong>INSTALL</strong> - installation instructions</li>
<li><strong>README</strong> - this file</li>
<li><strong>CMakeLists.txt</strong> - input for "cmake" build tool, see INSTALL</li>
<li><strong>configure</strong> - configuration script, see INSTALL for details.  If your copy of the source lacks a <code>configure</code> script, you can try to construct it by running the script in <code>build/autogen.sh</code> (or use <code>cmake</code>).</li>
</ul>
<p dir="auto">The following files in the top-level directory are used by the 'configure' script:</p>
<ul dir="auto">
<li><code>Makefile.am</code>, <code>aclocal.m4</code>, <code>configure.ac</code> - used to build this distribution, only needed by maintainers</li>
<li><code>Makefile.in</code>, <code>config.h.in</code> - templates used by configure script</li>
</ul>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Documentation</h2><a id="user-content-documentation" class="anchor" aria-label="Permalink: Documentation" href="#documentation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">In addition to the informational articles and documentation
in the online <a href="https://github.com/libarchive/libarchive/wiki">libarchive Wiki</a>,
the distribution also includes a number of manual pages:</p>
<ul dir="auto">
<li>bsdtar.1 explains the use of the bsdtar program</li>
<li>bsdcpio.1 explains the use of the bsdcpio program</li>
<li>bsdcat.1 explains the use of the bsdcat program</li>
<li>libarchive.3 gives an overview of the library as a whole</li>
<li>archive_read.3, archive_write.3, archive_write_disk.3, and
archive_read_disk.3 provide detailed calling sequences for the read
and write APIs</li>
<li>archive_entry.3 details the "struct archive_entry" utility class</li>
<li>archive_internals.3 provides some insight into libarchive's
internal structure and operation.</li>
<li>libarchive-formats.5 documents the file formats supported by the library</li>
<li>cpio.5, mtree.5, and tar.5 provide detailed information about these
popular archive formats, including hard-to-find details about
modern cpio and tar variants.</li>
</ul>
<p dir="auto">The manual pages above are provided in the 'doc' directory in
a number of different formats.</p>
<p dir="auto">You should also read the copious comments in <code>archive.h</code> and the
source code for the sample programs for more details.  Please let us
know about any errors or omissions you find.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Supported Formats</h2><a id="user-content-supported-formats" class="anchor" aria-label="Permalink: Supported Formats" href="#supported-formats"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Currently, the library automatically detects and reads the following formats:</p>
<ul dir="auto">
<li>Old V7 tar archives</li>
<li>POSIX ustar</li>
<li>GNU tar format (including GNU long filenames, long link names, and sparse files)</li>
<li>Solaris 9 extended tar format (including ACLs)</li>
<li>POSIX pax interchange format</li>
<li>POSIX octet-oriented cpio</li>
<li>SVR4 ASCII cpio</li>
<li>Binary cpio (big-endian or little-endian)</li>
<li>PWB binary cpio</li>
<li>ISO9660 CD-ROM images (with optional Rockridge or Joliet extensions)</li>
<li>ZIP archives (with uncompressed or "deflate" compressed entries, including support for encrypted Zip archives)</li>
<li>ZIPX archives (with support for bzip2, zstd, ppmd8, lzma and xz compressed entries)</li>
<li>GNU and BSD 'ar' archives</li>
<li>'mtree' format</li>
<li>7-Zip archives (including archives that use zstandard compression)</li>
<li>Microsoft CAB format</li>
<li>LHA and LZH archives</li>
<li>RAR and RAR 5.0 archives (with some limitations due to RAR's proprietary status)</li>
<li>WARC archives</li>
<li>XAR archives</li>
</ul>
<p dir="auto">The library also detects and handles any of the following before evaluating the archive:</p>
<ul dir="auto">
<li>uuencoded files</li>
<li>files with RPM wrapper</li>
<li>gzip compression</li>
<li>bzip2 compression</li>
<li>compress/LZW compression</li>
<li>lzma, lzip, and xz compression</li>
<li>lz4 compression</li>
<li>lzop compression</li>
<li>zstandard compression</li>
</ul>
<p dir="auto">The library can create archives in any of the following formats:</p>
<ul dir="auto">
<li>POSIX ustar</li>
<li>POSIX pax interchange format</li>
<li>"restricted" pax format, which will create ustar archives except for
entries that require pax extensions (for long filenames, ACLs, etc).</li>
<li>Old GNU tar format</li>
<li>Old V7 tar format</li>
<li>POSIX octet-oriented cpio</li>
<li>SVR4 "newc" cpio</li>
<li>Binary cpio (little-endian)</li>
<li>PWB binary cpio</li>
<li>shar archives</li>
<li>ZIP archives (with uncompressed or "deflate" compressed entries)</li>
<li>ZIPX archives (with bzip2, zstd, lzma or xz compressed entries)</li>
<li>GNU and BSD 'ar' archives</li>
<li>'mtree' format</li>
<li>ISO9660 format</li>
<li>7-Zip archives (including archives that use zstandard compression)</li>
<li>WARC archives</li>
<li>XAR archives</li>
</ul>
<p dir="auto">When creating archives, the result can be filtered with any of the following:</p>
<ul dir="auto">
<li>uuencode</li>
<li>base64</li>
<li>gzip compression</li>
<li>bzip2 compression</li>
<li>compress/LZW compression</li>
<li>lzma, lzip, and xz compression</li>
<li>lz4 compression</li>
<li>lzop compression</li>
<li>zstandard compression</li>
</ul>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Notes about the Library Design</h2><a id="user-content-notes-about-the-library-design" class="anchor" aria-label="Permalink: Notes about the Library Design" href="#notes-about-the-library-design"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The following notes address many of the most common
questions we are asked about libarchive:</p>
<ul dir="auto">
<li>
<p dir="auto">This is a heavily stream-oriented system.  That means that
it is optimized to read or write the archive in a single
pass from beginning to end.  For example, this allows
libarchive to process archives too large to store on disk
by processing them on-the-fly as they are read from or
written to a network or tape drive.  This also makes
libarchive useful for tools that need to produce
archives on-the-fly (such as webservers that provide
archived contents of a users account).</p>
</li>
<li>
<p dir="auto">In-place modification and random access to the contents
of an archive are not directly supported.  For some formats,
this is not an issue: For example, tar.gz archives are not
designed for random access.  In some other cases, libarchive
can re-open an archive and scan it from the beginning quickly
enough to provide the needed abilities even without true
random access.  Of course, some applications do require true
random access; those applications should consider alternatives
to libarchive.</p>
</li>
<li>
<p dir="auto">The library is designed to be extended with new compression and
archive formats.  The only requirement is that the format be
readable or writable as a stream and that each archive entry be
independent.  There are articles on the libarchive Wiki explaining
how to extend libarchive.</p>
</li>
<li>
<p dir="auto">On read, compression and format are always detected automatically.</p>
</li>
<li>
<p dir="auto">The same API is used for all formats; it should be very
easy for software using libarchive to transparently handle
any of libarchive's archiving formats.</p>
</li>
<li>
<p dir="auto">Libarchive's automatic support for decompression can be used
without archiving by explicitly selecting the "raw" and "empty"
formats.</p>
</li>
<li>
<p dir="auto">I've attempted to minimize static link pollution.  If you don't
explicitly invoke a particular feature (such as support for a
particular compression or format), it won't get pulled in to
statically-linked programs.  In particular, if you don't explicitly
enable a particular compression or decompression support, you won't
need to link against the corresponding compression or decompression
libraries.  This also reduces the size of statically-linked
binaries in environments where that matters.</p>
</li>
<li>
<p dir="auto">The library is generally <em>thread safe</em> depending on the platform:
it does not define any global variables of its own.  However, some
platforms do not provide fully thread-safe versions of key C library
functions.  On those platforms, libarchive will use the non-thread-safe
functions.  Patches to improve this are of great interest to us.</p>
</li>
<li>
<p dir="auto">The function <code>archive_write_disk_header()</code> is <em>not</em> thread safe on
POSIX machines and could lead to security issue resulting in world
writeable directories.  Thus it must be mutexed by the calling code.
This is due to calling <code>umask(oldumask = umask(0))</code>, which sets the
umask for the whole process to 0 for a short time frame.
In case other thread calls the same function in parallel, it might
get interrupted by it and cause the executable to use umask=0 for the
remaining execution.
This will then lead to implicitly created directories to have 777
permissions without sticky bit.</p>
</li>
<li>
<p dir="auto">In particular, libarchive's modules to read or write a directory
tree do use <code>chdir()</code> to optimize the directory traversals.  This
can cause problems for programs that expect to do disk access from
multiple threads.  Of course, those modules are completely
optional and you can use the rest of libarchive without them.</p>
</li>
<li>
<p dir="auto">The library is <em>not</em> thread aware, however.  It does no locking
or thread management of any kind.  If you create a libarchive
object and need to access it from multiple threads, you will
need to provide your own locking.</p>
</li>
<li>
<p dir="auto">On read, the library accepts whatever blocks you hand it.
Your read callback is free to pass the library a byte at a time
or mmap the entire archive and give it to the library at once.
On write, the library always produces correctly-blocked output.</p>
</li>
<li>
<p dir="auto">The object-style approach allows you to have multiple archive streams
open at once.  bsdtar uses this in its "@archive" extension.</p>
</li>
<li>
<p dir="auto">The archive itself is read/written using callback functions.
You can read an archive directly from an in-memory buffer or
write it to a socket, if you wish.  There are some utility
functions to provide easy-to-use "open file," etc, capabilities.</p>
</li>
<li>
<p dir="auto">The read/write APIs are designed to allow individual entries
to be read or written to any data source:  You can create
a block of data in memory and add it to a tar archive without
first writing a temporary file.  You can also read an entry from
an archive and write the data directly to a socket.  If you want
to read/write entries to disk, there are convenience functions to
make this especially easy.</p>
</li>
<li>
<p dir="auto">Note: The "pax interchange format" is a POSIX standard extended tar
format that should be used when the older <em>ustar</em> format is not
appropriate.  It has many advantages over other tar formats
(including the legacy GNU tar format) and is widely supported by
current tar implementations.</p>
</li>
</ul>
</article></div>