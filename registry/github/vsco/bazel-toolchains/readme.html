<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><div class="markdown-heading" dir="auto"><h1 class="heading-element" dir="auto">Bazel Toolchains</h1><a id="user-content-bazel-toolchains" class="anchor" aria-label="Permalink: Bazel Toolchains" href="#bazel-toolchains"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="https://travis-ci.org/vsco/bazel-toolchains" rel="nofollow"><img src="https://camo.githubusercontent.com/59a8cf27b8fc767284327f44ce536a236924b8afd61f10682680c04a516e2675/68747470733a2f2f7472617669732d63692e6f72672f7673636f2f62617a656c2d746f6f6c636861696e732e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/vsco/bazel-toolchains.svg?branch=master" style="max-width: 100%;"></a></p>
<p dir="auto">A collection of <a href="https://bazel.build" rel="nofollow">Bazel</a> C++ build infrastructure based on <a href="https://chromium.org" rel="nofollow">Chromium</a>'s
<a href="https://llvm.org" rel="nofollow">LLVM</a> toolchain. There are tags corresponding to Chromium releases. The build targets currently
supported are Linux x64 and macOS. As in Chromium, the Linux toolchain has a sysroot, bundled copies of binutils, and a
copy of libc++. The macOS build is less hermetic, and relies on system binutils and libraries.</p>
<p dir="auto">Use it in your Bazel WORKSPACE file like this:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="git_repository(
    name = 'co_vsco_bazel_toolchains',
    remote = 'https://github.com/vsco/bazel-toolchains',
    tag = 'v64.0.3282.167',
)

load(&quot;@co_vsco_bazel_toolchains//toolchains:repositories.bzl&quot;, &quot;bazel_toolchains_repositories&quot;)
bazel_toolchains_repositories()"><pre class="notranslate"><code>git_repository(
    name = 'co_vsco_bazel_toolchains',
    remote = 'https://github.com/vsco/bazel-toolchains',
    tag = 'v64.0.3282.167',
)

load("@co_vsco_bazel_toolchains//toolchains:repositories.bzl", "bazel_toolchains_repositories")
bazel_toolchains_repositories()
</code></pre></div>
<p dir="auto">Invoke Bazel with the custom toolchain:</p>
<p dir="auto"><code>bazel build --crosstool_top=@co_vsco_bazel_toolchains//tools/cpp:default-toolchain //your/build:target</code></p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Bazel Compatibility</h2><a id="user-content-bazel-compatibility" class="anchor" aria-label="Permalink: Bazel Compatibility" href="#bazel-compatibility"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><code>vsco/bazel-toolchains</code> is tested against the following build matrix:</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th align="left">Bazel Version</th>
<th align="center">OSX</th>
<th align="center">Linux</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">0.20.0+</td>
<td align="center">✗</td>
<td align="center">✗</td>
</tr>
<tr>
<td align="left">0.19.2</td>
<td align="center">✓</td>
<td align="center">✓</td>
</tr>
<tr>
<td align="left">0.18.1</td>
<td align="center">✓</td>
<td align="center">✓</td>
</tr>
<tr>
<td align="left">0.17.2</td>
<td align="center">✓</td>
<td align="center">✓</td>
</tr>
<tr>
<td align="left">0.16.1</td>
<td align="center">✓</td>
<td align="center">✓</td>
</tr>
<tr>
<td align="left">0.15.2</td>
<td align="center">✓</td>
<td align="center">✓</td>
</tr>
<tr>
<td align="left">0.14.1</td>
<td align="center">✓</td>
<td align="center">✓</td>
</tr>
<tr>
<td align="left">0.13.1</td>
<td align="center">✓</td>
<td align="center">✓</td>
</tr>
<tr>
<td align="left">0.12.0</td>
<td align="center">✓</td>
<td align="center">✓</td>
</tr>
<tr>
<td align="left"><del>0.11.x</del></td>
<td align="center">✗</td>
<td align="center">✗</td>
</tr>
<tr>
<td align="left"><del>0.10.x</del></td>
<td align="center">✗</td>
<td align="center">✗</td>
</tr>
<tr>
<td align="left"><del>0.9.x</del></td>
<td align="center">✗</td>
<td align="center">✗</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto">Builds beyond the listed versions are not currently tested.</p>
<p dir="auto">Bazel <code>0.20.0+</code> introduced breaking changes to the <a href="https://github.com/bazelbuild/bazel/issues/6434" data-hovercard-type="issue" data-hovercard-url="/bazelbuild/bazel/issues/6434/hovercard">C++ Toolchain API</a>
which need to be addressed for consumers of this repo in a non-breaking manner.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Prerequisites</h2><a id="user-content-prerequisites" class="anchor" aria-label="Permalink: Prerequisites" href="#prerequisites"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">On macOS, run <code>xcode-select --install</code> in Terminal.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Running the Python scripts</h2><a id="user-content-running-the-python-scripts" class="anchor" aria-label="Permalink: Running the Python scripts" href="#running-the-python-scripts"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The files in the <code>scripts/</code> directory are written in Python. Follow these
<a href="http://docs.python-guide.org/en/latest/starting/installation/" rel="nofollow">instructions</a>
to install a version of Python that comes with the necessary tools for installation of third party libraries. On macOS,
this means <code>brew install python</code>, and then following the instructions printed by <code>brew info python</code> (It's recommended to use <code>python@2</code> for macOS).</p>
<p dir="auto">Once that's working, type <code>pip install requests</code> to install the necessary dependencies.</p>
<p dir="auto">From the root of this repository, type <code>python scripts/generate_workspace.py --rev="64.0.3282.167"</code> where --rev is the
Chromium tag you wish to pull from. The script will print status messages to <code>stderr</code> and write a file similar to
toolchains/repositories.bzl to <code>stdout</code>.</p>
</article></div>