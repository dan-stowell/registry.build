<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><div class="markdown-heading" dir="auto"><h1 class="heading-element" dir="auto">rules_jvm_external</h1><a id="user-content-rules_jvm_external" class="anchor" aria-label="Permalink: rules_jvm_external" href="#rules_jvm_external"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Transitive Maven artifact resolution and publishing rules for Bazel.</p>
<ul dir="auto">
<li>Main build: <a href="https://buildkite.com/bazel/rules-jvm-external" rel="nofollow"><img src="https://camo.githubusercontent.com/71e9f165251fc8dc2c3e239e78473163eedd7cbbb486fb3a8aa4c411f7f29587/68747470733a2f2f62616467652e6275696c646b6974652e636f6d2f32366438393566353532353635326535373931356136303764306563643366633934356338323830613062646666383364392e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://badge.buildkite.com/26d895f5525652e57915a607d0ecd3fc945c8280a0bdff83d9.svg?branch=master" style="max-width: 100%;"></a></li>
<li>Examples build: <a href="https://buildkite.com/bazel/rules-jvm-external-examples" rel="nofollow"><img src="https://camo.githubusercontent.com/bda489e04891236e263b6c18ebb1b95bbdc9e46d2a9242bb85b81070719374e6/68747470733a2f2f62616467652e6275696c646b6974652e636f6d2f64316539336336633533323163396637643234633731643834396630303534326634616335633965656437363365636132642e737667" alt="Build status" data-canonical-src="https://badge.buildkite.com/d1e93c6c5321c9f7d24c71d849f00542f4ac5c9eed763eca2d.svg" style="max-width: 100%;"></a></li>
</ul>
<div class="markdown-heading" dir="auto"><h1 class="heading-element" dir="auto">Table of Contents</h1><a id="user-content-table-of-contents" class="anchor" aria-label="Permalink: Table of Contents" href="#table-of-contents"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><a href="#features">Features</a></li>
<li><a href="#examples">Examples</a>
<ul dir="auto">
<li><a href="#projects-using-rules_jvm_external">Projects using rules_jvm_external</a></li>
</ul>
</li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#usage">Usage</a>
<ul dir="auto">
<li><a href="#with-bzlmod-bazel-7-and-above">With bzlmod (Bazel 7 and above)</a></li>
<li><a href="#with-workspace-file-legacy">With WORKSPACE file (legacy)</a></li>
</ul>
</li>
<li><a href="#api-reference">API Reference</a></li>
<li><a href="#pinning-artifacts-and-integration-with-bazels-downloader">Pinning artifacts and integration with Bazel's downloader</a>
<ul dir="auto">
<li><a href="#updating-maven_installjson">Updating <code>maven_install.json</code></a></li>
<li><a href="#requiring-lock-file-repinning-when-the-list-of-artifacts-changes">Requiring lock file repinning when the list of artifacts changes</a></li>
<li><a href="#custom-location-for-maven_installjson">Custom location for <code>maven_install.json</code></a></li>
<li><a href="#multiple-maven_installjson-files">Multiple <code>maven_install.json</code> files</a></li>
</ul>
</li>
<li><a href="#experimental-support-for-maven-bom-files">(Experimental) Support for Maven BOM files</a></li>
<li><a href="#generated-targets">Generated targets</a></li>
<li><a href="#outdated-artifacts">Outdated artifacts</a></li>
<li><a href="#advanced-usage">Advanced usage</a>
<ul dir="auto">
<li><a href="#fetch-source-jars">Fetch source JARs</a></li>
<li><a href="#checksum-verification">Checksum verification</a></li>
<li><a href="#using-a-custom-coursier-download-url">Using a custom Coursier download url</a></li>
<li><a href="#artifact-helper-macro"><code>artifact</code> helper macro</a></li>
<li><a href="#java_plugin_artifact-helper-macro"><code>java_plugin_artifact</code> helper macro</a></li>
<li><a href="#multiple-maven_install-declarations-for-isolated-artifact-version-trees">Multiple <code>maven_install</code> declarations for isolated artifact version trees</a></li>
<li><a href="#detailed-dependency-information-specifications">Detailed dependency information specifications</a></li>
<li><a href="#artifact-exclusion">Artifact exclusion</a></li>
<li><a href="#compile-only-dependencies">Compile-only dependencies</a></li>
<li><a href="#test-only-dependencies">Test-only dependencies</a></li>
<li><a href="#resolving-user-specified-and-transitive-dependency-version-conflicts">Resolving user-specified and transitive dependency version conflicts</a></li>
<li><a href="#overriding-generated-targets">Overriding generated targets</a></li>
<li><a href="#proxies">Proxies</a></li>
<li><a href="#repository-aliases">Repository aliases</a></li>
<li><a href="#repository-remapping">Repository remapping</a></li>
<li><a href="#hiding-transitive-dependencies">Hiding transitive dependencies</a></li>
<li><a href="#accessing-transitive-dependencies-list">Accessing transitive dependencies list</a></li>
<li><a href="#fetch-and-resolve-timeout">Fetch and resolve timeout</a></li>
<li><a href="#ignoring-empty-jars">Ignoring empty jars</a></li>
<li><a href="#duplicate-artifact-warning">Duplicate artifact warning</a></li>
<li><a href="#provide-jvm-options-for-artifact-resolution">Provide JVM options for artifact resolution</a></li>
<li><a href="#provide-jvm-options-for-coursier-with-coursier_opts">Provide JVM options for Coursier with <code>COURSIER_OPTS</code></a></li>
<li><a href="#resolving-issues-with-nonstandard-system-default-jdks">Resolving issues with nonstandard system default JDKs</a></li>
<li><a href="#exporting-and-consuming-artifacts-from-external-repositories">Exporting and consuming artifacts from external repositories</a></li>
<li><a href="#publishing-to-external-repositories">Publishing to External Repositories</a></li>
</ul>
</li>
<li><a href="#configuring-the-dependency-resolver">Configuring the dependency resolver</a>
<ul dir="auto">
<li><a href="#common-options">Common options</a></li>
<li><a href="#configuring-coursier">Configuring Coursier</a></li>
<li><a href="#configuring-maven">Configuring Maven</a></li>
</ul>
</li>
<li><a href="#ipv6-support">IPv6 support</a></li>
<li><a href="#developing-this-project">Developing this project</a>
<ul dir="auto">
<li><a href="#verbose--debug-mode">Verbose / debug mode</a></li>
<li><a href="#tests">Tests</a></li>
<li><a href="#installing-the-android-sdk-on-macos">Installing the Android SDK on macOS</a></li>
<li><a href="#generating-documentation">Generating documentation</a></li>
</ul>
</li>
</ul>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Features</h2><a id="user-content-features" class="anchor" aria-label="Permalink: Features" href="#features"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>MODULE.bazel bzlmod configuration (Bazel 7 and above)</li>
<li>WORKSPACE configuration</li>
<li>Artifact version resolution with Coursier, Maven or Gradle</li>
<li>Import downloaded JAR, AAR, source JARs</li>
<li>Export built JARs to Maven repositories</li>
<li>Pin resolved artifacts with their SHA-256 checksums into a version-controllable JSON file</li>
<li>Custom Maven repositories</li>
<li>Private Maven repositories using <code>netrc</code> files</li>
<li>Integration with Bazel's downloader and caching mechanisms for sharing artifacts across Bazel workspaces</li>
<li>Versionless target labels for simpler dependency management</li>
<li>Ability to declare multiple sets of versioned artifacts</li>
<li>Supported on Windows, macOS, Linux</li>
</ul>
<p dir="auto">Get the <a href="https://github.com/bazelbuild/rules_jvm_external/releases/latest">latest release
here</a>.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Examples</h2><a id="user-content-examples" class="anchor" aria-label="Permalink: Examples" href="#examples"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">You can find examples in the <a href="./examples/"><code>examples/</code></a> directory.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Projects using rules_jvm_external</h3><a id="user-content-projects-using-rules_jvm_external" class="anchor" aria-label="Permalink: Projects using rules_jvm_external" href="#projects-using-rules_jvm_external"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Find other GitHub projects using <code>rules_jvm_external</code>
<a href="https://github.com/search?p=1&amp;q=rules_jvm_external+filename%3A%2FWORKSPACE+filename%3A%5C.bzl&amp;type=Code">with this search query</a>.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Prerequisites</h2><a id="user-content-prerequisites" class="anchor" aria-label="Permalink: Prerequisites" href="#prerequisites"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>Bazel 6.4.0, up to the current LTS version.</li>
<li>Support for Bazel versions between <code>5.4</code> and <code>7.x</code> is only available on releases <code>6.x</code>.</li>
<li>Support for Bazel versions between <code>4.x</code> and <code>5.4</code> is only available on releases <code>5.x</code>.</li>
<li>Support for Bazel versions before <code>4.0.0</code> is only available on releases <code>4.2</code> or earlier.</li>
</ul>
<p dir="auto"><strong>Compatibility guideline:</strong> This project aims to be backwards compatible with
the (current LTS - 2) version. If the current LTS version is 8, then we aim to
support versions 6, 7 and 8.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Usage</h2><a id="user-content-usage" class="anchor" aria-label="Permalink: Usage" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">With bzlmod (Bazel 7 and above)</h3><a id="user-content-with-bzlmod-bazel-7-and-above" class="anchor" aria-label="Permalink: With bzlmod (Bazel 7 and above)" href="#with-bzlmod-bazel-7-and-above"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">If you are starting a new project, or your project is already using Bazel 7 and
above, we recommend using <a href="https://bazel.build/external/overview" rel="nofollow"><code>bzlmod</code></a> to
manage your external dependencies, including Maven dependencies with
<code>rules_jvm_external</code>. It address several shortcomings of the <code>WORKSPACE</code>
mechanism. If you are unable to use <code>bzlmod</code>, <code>rules_jvm_external</code> also supports
the <code>WORKSPACE</code> mechanism (see below).</p>
<p dir="auto">See <a href="./docs/bzlmod.md">bzlmod.md</a> for the usage instructions. bzlmod is
on-by-default in Bazel 7.0.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">With WORKSPACE file (legacy)</h3><a id="user-content-with-workspace-file-legacy" class="anchor" aria-label="Permalink: With WORKSPACE file (legacy)" href="#with-workspace-file-legacy"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">NOTE: WORKSPACE support is disabled by default in Bazel 8.0, and will be removed in Bazel 9.0.</p>
<p dir="auto">List the top-level Maven artifacts and servers in the WORKSPACE:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="load(&quot;@bazel_tools//tools/build_defs/repo:http.bzl&quot;, &quot;http_archive&quot;)

RULES_JVM_EXTERNAL_TAG = &quot;4.5&quot;
RULES_JVM_EXTERNAL_SHA = &quot;b17d7388feb9bfa7f2fa09031b32707df529f26c91ab9e5d909eb1676badd9a6&quot;

http_archive(
    name = &quot;rules_jvm_external&quot;,
    strip_prefix = &quot;rules_jvm_external-%s&quot; % RULES_JVM_EXTERNAL_TAG,
    sha256 = RULES_JVM_EXTERNAL_SHA,
    url = &quot;https://github.com/bazelbuild/rules_jvm_external/archive/%s.zip&quot; % RULES_JVM_EXTERNAL_TAG,
)

load(&quot;@rules_jvm_external//:repositories.bzl&quot;, &quot;rules_jvm_external_deps&quot;)

rules_jvm_external_deps()

load(&quot;@rules_jvm_external//:setup.bzl&quot;, &quot;rules_jvm_external_setup&quot;)

rules_jvm_external_setup()

load(&quot;@rules_jvm_external//:defs.bzl&quot;, &quot;maven_install&quot;)

maven_install(
    artifacts = [
        &quot;junit:junit:4.12&quot;,
        &quot;androidx.test.espresso:espresso-core:3.1.1&quot;,
        &quot;org.hamcrest:hamcrest-library:1.3&quot;,
    ],
    repositories = [
        # Private repositories are supported through HTTP Basic auth
        &quot;http://username:password@localhost:8081/artifactory/my-repository&quot;,
        &quot;https://maven.google.com&quot;,
        &quot;https://repo1.maven.org/maven2&quot;,
    ],
)"><pre><span class="pl-en">load</span>(<span class="pl-s">"@bazel_tools//tools/build_defs/repo:http.bzl"</span>, <span class="pl-s">"http_archive"</span>)

<span class="pl-c1">RULES_JVM_EXTERNAL_TAG</span> <span class="pl-c1">=</span> <span class="pl-s">"4.5"</span>
<span class="pl-c1">RULES_JVM_EXTERNAL_SHA</span> <span class="pl-c1">=</span> <span class="pl-s">"b17d7388feb9bfa7f2fa09031b32707df529f26c91ab9e5d909eb1676badd9a6"</span>

<span class="pl-en">http_archive</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"rules_jvm_external"</span>,
    <span class="pl-s1">strip_prefix</span> <span class="pl-c1">=</span> <span class="pl-s">"rules_jvm_external-%s"</span> <span class="pl-c1">%</span> <span class="pl-c1">RULES_JVM_EXTERNAL_TAG</span>,
    <span class="pl-s1">sha256</span> <span class="pl-c1">=</span> <span class="pl-c1">RULES_JVM_EXTERNAL_SHA</span>,
    <span class="pl-s1">url</span> <span class="pl-c1">=</span> <span class="pl-s">"https://github.com/bazelbuild/rules_jvm_external/archive/%s.zip"</span> <span class="pl-c1">%</span> <span class="pl-c1">RULES_JVM_EXTERNAL_TAG</span>,
)

<span class="pl-en">load</span>(<span class="pl-s">"@rules_jvm_external//:repositories.bzl"</span>, <span class="pl-s">"rules_jvm_external_deps"</span>)

<span class="pl-en">rules_jvm_external_deps</span>()

<span class="pl-en">load</span>(<span class="pl-s">"@rules_jvm_external//:setup.bzl"</span>, <span class="pl-s">"rules_jvm_external_setup"</span>)

<span class="pl-en">rules_jvm_external_setup</span>()

<span class="pl-en">load</span>(<span class="pl-s">"@rules_jvm_external//:defs.bzl"</span>, <span class="pl-s">"maven_install"</span>)

<span class="pl-en">maven_install</span>(
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"junit:junit:4.12"</span>,
        <span class="pl-s">"androidx.test.espresso:espresso-core:3.1.1"</span>,
        <span class="pl-s">"org.hamcrest:hamcrest-library:1.3"</span>,
    ],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># Private repositories are supported through HTTP Basic auth</span>
        <span class="pl-s">"http://username:password@localhost:8081/artifactory/my-repository"</span>,
        <span class="pl-s">"https://maven.google.com"</span>,
        <span class="pl-s">"https://repo1.maven.org/maven2"</span>,
    ],
)</pre></div>
<p dir="auto">Credentials for private repositories can also be specified using a property file
or environment variables. See the <a href="https://get-coursier.io/docs/other-credentials.html#property-file" rel="nofollow">Coursier
documentation</a>
for more information.</p>
<p dir="auto"><code>rules_jvm_external_deps</code> uses a default list of maven repositories to download
<code>rules_jvm_external</code>'s own dependencies from. Should you wish to change this,
use the <code>repositories</code> parameter, and also set the path to the lock file:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="rules_jvm_external_deps(
   repositories = [&quot;https://mycorp.com/artifacts&quot;],
   deps_lock_file = &quot;@//:rules_jvm_external_deps_install.json&quot;)
rules_jvm_external_setup()"><pre><span class="pl-en">rules_jvm_external_deps</span>(
   <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [<span class="pl-s">"https://mycorp.com/artifacts"</span>],
   <span class="pl-s1">deps_lock_file</span> <span class="pl-c1">=</span> <span class="pl-s">"@//:rules_jvm_external_deps_install.json"</span>)
<span class="pl-en">rules_jvm_external_setup</span>()</pre></div>
<p dir="auto">If you are using <code>bzlmod</code>, define an <code>install</code> tag in your root
<code>MODULE.bazel</code> which overrides the values:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven.install(
    name = &quot;rules_jvm_external_deps&quot;,
    repositories = [&quot;https://mycorp.com/artifacts&quot;],
    lock_file = &quot;//:rules_jvm_external_deps_install.json&quot;,
)"><pre><span class="pl-s1">maven</span>.<span class="pl-c1">install</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"rules_jvm_external_deps"</span>,
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [<span class="pl-s">"https://mycorp.com/artifacts"</span>],
    <span class="pl-s1">lock_file</span> <span class="pl-c1">=</span> <span class="pl-s">"//:rules_jvm_external_deps_install.json"</span>,
)</pre></div>
<p dir="auto">Once these changes have been made, repin using <code>REPIN=1 bazel run @rules_jvm_external_deps//:pin</code> and commit the file to your version
control system (note that at this point you will need to maintain your
customized <code>rules_jvm_external_deps_install.json</code>):</p>
<p dir="auto">Next, reference the artifacts in the BUILD file with their versionless label:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="java_library(
    name = &quot;java_test_deps&quot;,
    exports = [
        &quot;@maven//:junit_junit&quot;,
        &quot;@maven//:org_hamcrest_hamcrest_library&quot;,
    ],
)

android_library(
    name = &quot;android_test_deps&quot;,
    exports = [
        &quot;@maven//:junit_junit&quot;,
        &quot;@maven//:androidx_test_espresso_espresso_core&quot;,
    ],
)"><pre><span class="pl-en">java_library</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"java_test_deps"</span>,
    <span class="pl-s1">exports</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"@maven//:junit_junit"</span>,
        <span class="pl-s">"@maven//:org_hamcrest_hamcrest_library"</span>,
    ],
)

<span class="pl-en">android_library</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"android_test_deps"</span>,
    <span class="pl-s1">exports</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"@maven//:junit_junit"</span>,
        <span class="pl-s">"@maven//:androidx_test_espresso_espresso_core"</span>,
    ],
)</pre></div>
<p dir="auto">The default label syntax for an artifact <code>foo.bar:baz-qux:1.2.3</code> is <code>@maven//:foo_bar_baz_qux</code>. That is,</p>
<ul dir="auto">
<li>All non-alphanumeric characters are substituted with underscores.</li>
<li>Only the group and artifact IDs are required.</li>
<li>The target is located in the <code>@maven</code> top level package (<code>@maven//</code>).</li>
</ul>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">API Reference</h2><a id="user-content-api-reference" class="anchor" aria-label="Permalink: API Reference" href="#api-reference"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">You can find the complete API reference at <a href="docs/api.md">docs/api.md</a>.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Pinning artifacts and integration with Bazel's downloader</h2><a id="user-content-pinning-artifacts-and-integration-with-bazels-downloader" class="anchor" aria-label="Permalink: Pinning artifacts and integration with Bazel's downloader" href="#pinning-artifacts-and-integration-with-bazels-downloader"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><code>rules_jvm_external</code> supports pinning artifacts and their SHA-256 checksums into
a <code>maven_install.json</code> file that can be checked into your repository.</p>
<p dir="auto">Without artifact pinning, in a clean checkout of your project, <code>rules_jvm_external</code>
executes the full artifact resolution and fetching steps (which can take a bit of time)
and does not verify the integrity of the artifacts against their checksums. The
downloaded artifacts also cannot be shared across Bazel workspaces.</p>
<p dir="auto">By pinning artifact versions, you can get improved artifact resolution and build times,
since using <code>maven_install.json</code> enables <code>rules_jvm_external</code> to integrate with Bazel's
downloader that caches files on their sha256 checksums. It also improves resiliency and
integrity by tracking the sha256 checksums and original artifact urls in the
JSON file.</p>
<p dir="auto">Since all artifacts are persisted locally in Bazel's cache, it means that
<strong>fully offline builds are possible</strong> after the initial <code>bazel fetch @maven//...</code>.
The artifacts are downloaded with <code>http_file</code> which supports <code>netrc</code> for authentication.
Your <code>~/.netrc</code> will be included automatically.
To pass machine login credentials in the ~/.netrc file to coursier, specify
<code>use_credentials_from_home_netrc_file = True</code> in your <code>maven_install</code> rule.
For additional credentials, add them in the repository URLs passed to <code>maven_install</code>
(so they will be included in the generated JSON).
Alternatively, pass an array of <code>additional_netrc_lines</code> to <code>maven_install</code> for authentication with credentials from
outside the workspace.</p>
<p dir="auto">To get started with pinning artifacts, run the following command to generate the
initial <code>maven_install.json</code> at the root of your Bazel workspace:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="$ bazel run @maven//:pin"><pre class="notranslate"><code>$ bazel run @maven//:pin
</code></pre></div>
<p dir="auto">Then, specify <code>maven_install_json</code> in <code>maven_install</code> and load
<code>pinned_maven_install</code> from <code>@maven//:defs.bzl</code>:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven_install(
    # artifacts, repositories, ...
    maven_install_json = &quot;//:maven_install.json&quot;,
)

load(&quot;@maven//:defs.bzl&quot;, &quot;pinned_maven_install&quot;)
pinned_maven_install()"><pre><span class="pl-en">maven_install</span>(
    <span class="pl-c"># artifacts, repositories, ...</span>
    <span class="pl-s1">maven_install_json</span> <span class="pl-c1">=</span> <span class="pl-s">"//:maven_install.json"</span>,
)

<span class="pl-en">load</span>(<span class="pl-s">"@maven//:defs.bzl"</span>, <span class="pl-s">"pinned_maven_install"</span>)
<span class="pl-en">pinned_maven_install</span>()</pre></div>
<p dir="auto"><strong>Note:</strong> The <code>//:maven_install.json</code> label assumes you have a BUILD file in
your project's root directory. If you do not have one, create an empty BUILD
file to fix issues you may see. See
<a href="https://github.com/bazelbuild/rules_jvm_external/issues/242" data-hovercard-type="issue" data-hovercard-url="/bazel-contrib/rules_jvm_external/issues/242/hovercard">#242</a></p>
<p dir="auto"><strong>Note:</strong> If you're using an older version of <code>rules_jvm_external</code> and
haven't repinned your dependencies, you may see a warning that you lock
file "does not contain a signature of the required artifacts" then don't
worry: either ignore the warning or repin the dependencies.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Updating <code>maven_install.json</code></h3><a id="user-content-updating-maven_installjson" class="anchor" aria-label="Permalink: Updating maven_install.json" href="#updating-maven_installjson"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Whenever you make a change to the list of <code>artifacts</code> or <code>repositories</code> and want
to update <code>maven_install.json</code>, run this command to re-pin the unpinned <code>@maven</code>
repository:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="$ REPIN=1 bazel run @maven//:pin"><pre class="notranslate"><code>$ REPIN=1 bazel run @maven//:pin
</code></pre></div>
<p dir="auto">Without re-pinning, <code>maven_install</code> will not pick up the changes made to the
WORKSPACE, as <code>maven_install.json</code> is now the source of truth.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Requiring lock file repinning when the list of artifacts changes</h3><a id="user-content-requiring-lock-file-repinning-when-the-list-of-artifacts-changes" class="anchor" aria-label="Permalink: Requiring lock file repinning when the list of artifacts changes" href="#requiring-lock-file-repinning-when-the-list-of-artifacts-changes"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">It can be easy to forget to update the <code>maven_install.json</code> lock file
when updating artifacts in a <code>maven_install</code>. Normally,
rules_jvm_external will print a warning to the console and continue
the build when this happens, but by setting the
<code>fail_if_repin_required</code> attribute to <code>True</code>, this will be treated as
a build error, causing the build to fail. When this attribute is set,
it is possible to update the <code>maven_install.json</code> file using:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# To repin everything:
REPIN=1 bazel run @maven//:pin

# To only repin rules_jvm_external:
RULES_JVM_EXTERNAL_REPIN=1 bazel run @maven//:pin"><pre><span class="pl-c"><span class="pl-c">#</span> To repin everything:</span>
REPIN=1 bazel run @maven//:pin

<span class="pl-c"><span class="pl-c">#</span> To only repin rules_jvm_external:</span>
RULES_JVM_EXTERNAL_REPIN=1 bazel run @maven//:pin</pre></div>
<p dir="auto">Alternatively, it is also possible to modify the
<code>fail_if_repin_required</code> attribute in your <code>WORKSPACE</code> file, run
<code>bazel run @maven//:pin</code> and then reset the
<code>fail_if_repin_required</code> attribute.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Custom location for <code>maven_install.json</code></h3><a id="user-content-custom-location-for-maven_installjson" class="anchor" aria-label="Permalink: Custom location for maven_install.json" href="#custom-location-for-maven_installjson"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">You can specify a custom location for <code>maven_install.json</code> by changing the
<code>maven_install_json</code> attribute value to point to the new file label. For example:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven_install(
    name = &quot;maven_install_in_custom_location&quot;,
    artifacts = [&quot;com.google.guava:guava:27.0-jre&quot;],
    repositories = [&quot;https://repo1.maven.org/maven2&quot;],
    maven_install_json = &quot;@rules_jvm_external//tests/custom_maven_install:maven_install.json&quot;,
)

load(&quot;@maven_install_in_custom_location//:defs.bzl&quot;, &quot;pinned_maven_install&quot;)
pinned_maven_install()"><pre><span class="pl-en">maven_install</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"maven_install_in_custom_location"</span>,
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [<span class="pl-s">"com.google.guava:guava:27.0-jre"</span>],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [<span class="pl-s">"https://repo1.maven.org/maven2"</span>],
    <span class="pl-s1">maven_install_json</span> <span class="pl-c1">=</span> <span class="pl-s">"@rules_jvm_external//tests/custom_maven_install:maven_install.json"</span>,
)

<span class="pl-en">load</span>(<span class="pl-s">"@maven_install_in_custom_location//:defs.bzl"</span>, <span class="pl-s">"pinned_maven_install"</span>)
<span class="pl-en">pinned_maven_install</span>()</pre></div>
<p dir="auto">Future artifact pinning updates to <code>maven_install.json</code> will overwrite the file
at the specified path instead of creating a new one at the default root
directory location.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Multiple <code>maven_install.json</code> files</h3><a id="user-content-multiple-maven_installjson-files" class="anchor" aria-label="Permalink: Multiple maven_install.json files" href="#multiple-maven_installjson-files"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">If you have multiple <code>maven_install</code> declarations, you have to alias
<code>pinned_maven_install</code> to another name to prevent redefinitions:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven_install(
    name = &quot;foo&quot;,
    maven_install_json = &quot;//:foo_maven_install.json&quot;,
    # ...
)

load(&quot;@foo//:defs.bzl&quot;, foo_pinned_maven_install = &quot;pinned_maven_install&quot;)
foo_pinned_maven_install()

maven_install(
    name = &quot;bar&quot;,
    maven_install_json = &quot;//:bar_maven_install.json&quot;,
    # ...
)

load(&quot;@bar//:defs.bzl&quot;, bar_pinned_maven_install = &quot;pinned_maven_install&quot;)
bar_pinned_maven_install()"><pre><span class="pl-en">maven_install</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"foo"</span>,
    <span class="pl-s1">maven_install_json</span> <span class="pl-c1">=</span> <span class="pl-s">"//:foo_maven_install.json"</span>,
    <span class="pl-c"># ...</span>
)

<span class="pl-en">load</span>(<span class="pl-s">"@foo//:defs.bzl"</span>, <span class="pl-s1">foo_pinned_maven_install</span> <span class="pl-c1">=</span> <span class="pl-s">"pinned_maven_install"</span>)
<span class="pl-en">foo_pinned_maven_install</span>()

<span class="pl-en">maven_install</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"bar"</span>,
    <span class="pl-s1">maven_install_json</span> <span class="pl-c1">=</span> <span class="pl-s">"//:bar_maven_install.json"</span>,
    <span class="pl-c"># ...</span>
)

<span class="pl-en">load</span>(<span class="pl-s">"@bar//:defs.bzl"</span>, <span class="pl-s1">bar_pinned_maven_install</span> <span class="pl-c1">=</span> <span class="pl-s">"pinned_maven_install"</span>)
<span class="pl-en">bar_pinned_maven_install</span>()</pre></div>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">(Experimental) Support for Maven BOM files</h2><a id="user-content-experimental-support-for-maven-bom-files" class="anchor" aria-label="Permalink: (Experimental) Support for Maven BOM files" href="#experimental-support-for-maven-bom-files"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Maven BOMs can be used by using the <code>boms</code> attribute, for example:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven.install(
    boms = [
        &quot;org.seleniumhq.selenium:selenium-bom:4.18.1&quot;,
    ],
    artifacts = [
        # This dependency is included in the `selenium-bom`, so we can omit the version number
        &quot;org.seleniumhq.selenium:selenium-java&quot;,
    ],
)"><pre><span class="pl-s1">maven</span>.<span class="pl-c1">install</span>(
    <span class="pl-s1">boms</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"org.seleniumhq.selenium:selenium-bom:4.18.1"</span>,
    ],
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># This dependency is included in the `selenium-bom`, so we can omit the version number</span>
        <span class="pl-s">"org.seleniumhq.selenium:selenium-java"</span>,
    ],
)</pre></div>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Generated targets</h2><a id="user-content-generated-targets" class="anchor" aria-label="Permalink: Generated targets" href="#generated-targets"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">For the <code>junit:junit</code> example, using <code>bazel query @maven//:all --output=build</code>, we can see that the rule generated these targets:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="alias(
  name = &quot;junit_junit_4_12&quot;,
  actual = &quot;@maven//:junit_junit&quot;,
)

jvm_import(
  name = &quot;junit_junit&quot;,
  jars = [&quot;@maven//:https/repo1.maven.org/maven2/junit/junit/4.12/junit-4.12.jar&quot;],
  srcjar = &quot;@maven//:https/repo1.maven.org/maven2/junit/junit/4.12/junit-4.12-sources.jar&quot;,
  deps = [&quot;@maven//:org_hamcrest_hamcrest_core&quot;],
  tags = [&quot;maven_coordinates=junit:junit:4.12&quot;],
)

jvm_import(
  name = &quot;org_hamcrest_hamcrest_core&quot;,
  jars = [&quot;@maven//:https/repo1.maven.org/maven2/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar&quot;],
  srcjar = &quot;@maven//:https/repo1.maven.org/maven2/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3-sources.jar&quot;,
  deps = [],
  tags = [&quot;maven_coordinates=org.hamcrest:hamcrest.library:1.3&quot;],
)"><pre><span class="pl-en">alias</span>(
  <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"junit_junit_4_12"</span>,
  <span class="pl-s1">actual</span> <span class="pl-c1">=</span> <span class="pl-s">"@maven//:junit_junit"</span>,
)

<span class="pl-en">jvm_import</span>(
  <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"junit_junit"</span>,
  <span class="pl-s1">jars</span> <span class="pl-c1">=</span> [<span class="pl-s">"@maven//:https/repo1.maven.org/maven2/junit/junit/4.12/junit-4.12.jar"</span>],
  <span class="pl-s1">srcjar</span> <span class="pl-c1">=</span> <span class="pl-s">"@maven//:https/repo1.maven.org/maven2/junit/junit/4.12/junit-4.12-sources.jar"</span>,
  <span class="pl-s1">deps</span> <span class="pl-c1">=</span> [<span class="pl-s">"@maven//:org_hamcrest_hamcrest_core"</span>],
  <span class="pl-s1">tags</span> <span class="pl-c1">=</span> [<span class="pl-s">"maven_coordinates=junit:junit:4.12"</span>],
)

<span class="pl-en">jvm_import</span>(
  <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"org_hamcrest_hamcrest_core"</span>,
  <span class="pl-s1">jars</span> <span class="pl-c1">=</span> [<span class="pl-s">"@maven//:https/repo1.maven.org/maven2/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar"</span>],
  <span class="pl-s1">srcjar</span> <span class="pl-c1">=</span> <span class="pl-s">"@maven//:https/repo1.maven.org/maven2/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3-sources.jar"</span>,
  <span class="pl-s1">deps</span> <span class="pl-c1">=</span> [],
  <span class="pl-s1">tags</span> <span class="pl-c1">=</span> [<span class="pl-s">"maven_coordinates=org.hamcrest:hamcrest.library:1.3"</span>],
)</pre></div>
<p dir="auto">These targets can be referenced by:</p>
<ul dir="auto">
<li><code>@maven//:junit_junit</code></li>
<li><code>@maven//:org_hamcrest_hamcrest_core</code></li>
</ul>
<p dir="auto"><strong>Transitive classes</strong>: To use a class from <code>hamcrest-core</code> in your test, it's not sufficient to just
depend on <code>@maven//:junit_junit</code> even though JUnit depends on Hamcrest. The compile classes are not exported
transitively, so your test should also depend on <code>@maven//:org_hamcrest_hamcrest_core</code>.</p>
<p dir="auto"><strong>Original coordinates</strong>: The generated <code>tags</code> attribute value also contains the original coordinates of
the artifact, which integrates with rules like <a href="https://github.com/google/bazel-common/blob/f1115e0f777f08c3cdb115526c4e663005bec69b/tools/maven/pom_file.bzl#L177">bazel-common's
<code>pom_file</code></a>
for generating POM files. See the <a href="examples/pom_file_generation/"><code>pom_file_generation</code>
example</a> for more information.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Outdated artifacts</h2><a id="user-content-outdated-artifacts" class="anchor" aria-label="Permalink: Outdated artifacts" href="#outdated-artifacts"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">To check for updates of artifacts, run the following command at the root of your Bazel workspace:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="$ bazel run @maven//:outdated"><pre class="notranslate"><code>$ bazel run @maven//:outdated
</code></pre></div>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Advanced usage</h2><a id="user-content-advanced-usage" class="anchor" aria-label="Permalink: Advanced usage" href="#advanced-usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Fetch source JARs</h3><a id="user-content-fetch-source-jars" class="anchor" aria-label="Permalink: Fetch source JARs" href="#fetch-source-jars"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">To download the source JAR alongside the main artifact JAR, set <code>fetch_sources = True</code> in <code>maven_install</code>:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven_install(
    artifacts = [
        # ...
    ],
    repositories = [
        # ...
    ],
    fetch_sources = True,
)"><pre><span class="pl-en">maven_install</span>(
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># ...</span>
    ],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># ...</span>
    ],
    <span class="pl-s1">fetch_sources</span> <span class="pl-c1">=</span> <span class="pl-c1">True</span>,
)</pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Checksum verification</h3><a id="user-content-checksum-verification" class="anchor" aria-label="Permalink: Checksum verification" href="#checksum-verification"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Artifact resolution will fail if a <code>SHA-1</code> or <code>MD5</code> checksum file for the
artifact is missing in the repository. To disable this behavior, set
<code>fail_on_missing_checksum = False</code> in <code>maven_install</code>:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven_install(
    artifacts = [
        # ...
    ],
    repositories = [
        # ...
    ],
    fail_on_missing_checksum = False,
)"><pre><span class="pl-en">maven_install</span>(
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># ...</span>
    ],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># ...</span>
    ],
    <span class="pl-s1">fail_on_missing_checksum</span> <span class="pl-c1">=</span> <span class="pl-c1">False</span>,
)</pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Using a custom Coursier download url</h3><a id="user-content-using-a-custom-coursier-download-url" class="anchor" aria-label="Permalink: Using a custom Coursier download url" href="#using-a-custom-coursier-download-url"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">By default bazel bootstraps Coursier via <a href="private/versions.bzl">the urls specificed in versions.bzl</a>.
However in case they are not directly accessible in your environment, you can also specify a custom
url to download Coursier. For example:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="$ bazel build @maven_with_unsafe_shared_cache//... --repo_env=COURSIER_URL='https://my_secret_host.com/vXYZ/coursier.jar'"><pre class="notranslate"><code>$ bazel build @maven_with_unsafe_shared_cache//... --repo_env=COURSIER_URL='https://my_secret_host.com/vXYZ/coursier.jar'
</code></pre></div>
<p dir="auto">Please note it still requires the SHA to match.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto"><code>artifact</code> helper macro</h3><a id="user-content-artifact-helper-macro" class="anchor" aria-label="Permalink: artifact helper macro" href="#artifact-helper-macro"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The <code>artifact</code> macro translates the artifact's <code>group:artifact</code> coordinates to
the label of the versionless target. This target is an
<a href="https://docs.bazel.build/versions/master/be/general.html#alias" rel="nofollow">alias</a> that
points to the <code>java_import</code>/<code>aar_import</code> target in the <code>@maven</code> repository,
which includes the transitive dependencies specified in the top level artifact's
POM file.</p>
<p dir="auto">For example, <code>@maven//:junit_junit</code> is equivalent to <code>artifact("junit:junit")</code>.</p>
<p dir="auto">To use it, add the load statement to the top of your BUILD file:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="load(&quot;@rules_jvm_external//:defs.bzl&quot;, &quot;artifact&quot;)"><pre><span class="pl-en">load</span>(<span class="pl-s">"@rules_jvm_external//:defs.bzl"</span>, <span class="pl-s">"artifact"</span>)</pre></div>
<p dir="auto">Full <code>group:artifact:[packaging:[classifier:]]version</code> maven coordinates are also
supported and translate to corresponding versionless target.</p>
<p dir="auto">Note that usage of this macro makes BUILD file refactoring with tools like
<code>buildozer</code> more difficult, because the macro hides the actual target label at
the syntax level.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto"><code>java_plugin_artifact</code> helper macro</h3><a id="user-content-java_plugin_artifact-helper-macro" class="anchor" aria-label="Permalink: java_plugin_artifact helper macro" href="#java_plugin_artifact-helper-macro"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The <code>java_plugin_artifact</code> macro finds a <code>java_plugin</code> target which can be used
to run an annotation procesor from a particular artifact.</p>
<p dir="auto">For example, if you pull <code>com.google.auto.value:auto-value</code> into a
<code>maven_install</code>, you can use the <code>java_plugin_artifact</code> macro in the <code>plugins</code>
attribute of a target like <code>java_library</code>:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="java_library(
    name = &quot;some_lib&quot;,
    srcs = [&quot;SrcUsingAuto.java&quot;],
    plugins = [
        java_plugin_artifact(&quot;com.google.auto.value:auto-value&quot;, &quot;com.google.auto.value.processor.AutoValueProcessor&quot;),
    ],
)"><pre><span class="pl-en">java_library</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"some_lib"</span>,
    <span class="pl-s1">srcs</span> <span class="pl-c1">=</span> [<span class="pl-s">"SrcUsingAuto.java"</span>],
    <span class="pl-s1">plugins</span> <span class="pl-c1">=</span> [
        <span class="pl-en">java_plugin_artifact</span>(<span class="pl-s">"com.google.auto.value:auto-value"</span>, <span class="pl-s">"com.google.auto.value.processor.AutoValueProcessor"</span>),
    ],
)</pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Multiple <code>maven_install</code> declarations for isolated artifact version trees</h3><a id="user-content-multiple-maven_install-declarations-for-isolated-artifact-version-trees" class="anchor" aria-label="Permalink: Multiple maven_install declarations for isolated artifact version trees" href="#multiple-maven_install-declarations-for-isolated-artifact-version-trees"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">If your WORKSPACE contains several projects that use different versions of the
same artifact, you can specify multiple <code>maven_install</code> declarations in the
WORKSPACE, with a unique repository name for each of them.</p>
<p dir="auto">For example, if you want to use the JRE version of Guava for a server app, and
the Android version for an Android app, you can specify two <code>maven_install</code>
declarations:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven_install(
    name = &quot;server_app&quot;,
    artifacts = [
        &quot;com.google.guava:guava:27.0-jre&quot;,
    ],
    repositories = [
        &quot;https://repo1.maven.org/maven2&quot;,
    ],
)

maven_install(
    name = &quot;android_app&quot;,
    artifacts = [
        &quot;com.google.guava:guava:27.0-android&quot;,
    ],
    repositories = [
        &quot;https://repo1.maven.org/maven2&quot;,
    ],
)"><pre><span class="pl-en">maven_install</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"server_app"</span>,
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"com.google.guava:guava:27.0-jre"</span>,
    ],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"https://repo1.maven.org/maven2"</span>,
    ],
)

<span class="pl-en">maven_install</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"android_app"</span>,
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"com.google.guava:guava:27.0-android"</span>,
    ],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"https://repo1.maven.org/maven2"</span>,
    ],
)</pre></div>
<p dir="auto">This way, <code>rules_jvm_external</code> will invoke coursier to resolve artifact versions for
both repositories independent of each other. Coursier will fail if it encounters
version conflicts that it cannot resolve. The two Guava targets can then be used
in BUILD files like so:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="java_binary(
    name = &quot;my_server_app&quot;,
    srcs = ...
    deps = [
        # a versionless alias to @server_app//:com_google_guava_guava_27_0_jre
        &quot;@server_app//:com_google_guava_guava&quot;,
    ]
)

android_binary(
    name = &quot;my_android_app&quot;,
    srcs = ...
    deps = [
        # a versionless alias to @android_app//:com_google_guava_guava_27_0_android
        &quot;@android_app//:com_google_guava_guava&quot;,
    ]
)"><pre><span class="pl-en">java_binary</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"my_server_app"</span>,
    <span class="pl-s1">srcs</span> <span class="pl-c1">=</span> ...
    <span class="pl-s1">deps</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># a versionless alias to @server_app//:com_google_guava_guava_27_0_jre</span>
        <span class="pl-s">"@server_app//:com_google_guava_guava"</span>,
    ]
)

<span class="pl-en">android_binary</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"my_android_app"</span>,
    <span class="pl-s1">srcs</span> <span class="pl-c1">=</span> ...
    <span class="pl-s1">deps</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># a versionless alias to @android_app//:com_google_guava_guava_27_0_android</span>
        <span class="pl-s">"@android_app//:com_google_guava_guava"</span>,
    ]
)</pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Detailed dependency information specifications</h3><a id="user-content-detailed-dependency-information-specifications" class="anchor" aria-label="Permalink: Detailed dependency information specifications" href="#detailed-dependency-information-specifications"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Although you can always give a dependency as a Maven coordinate string,
occasionally special handling is required in the form of additional directives
to properly situate the artifact in the dependency tree. For example, a given
artifact may need to have one of its dependencies excluded to prevent a
conflict.</p>
<p dir="auto">This situation is provided for by allowing the artifact to be specified as a map
containing all of the required information. This map can express more
information than the coordinate strings can, so internally the coordinate
strings are parsed into the artifact map with default values for the additional
items. To assist in generating the maps, you can pull in the file <code>specs.bzl</code>
alongside <code>defs.bzl</code> and import the <code>maven</code> struct, which provides several
helper functions to assist in creating these maps. An example:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="load(&quot;@rules_jvm_external//:defs.bzl&quot;, &quot;artifact&quot;)
load(&quot;@rules_jvm_external//:specs.bzl&quot;, &quot;maven&quot;)

maven_install(
    artifacts = [
        maven.artifact(
            group = &quot;com.google.guava&quot;,
            artifact = &quot;guava&quot;,
            version = &quot;27.0-android&quot;,
            exclusions = [
                ...
            ]
        ),
        &quot;junit:junit:4.12&quot;,
        ...
    ],
    repositories = [
        maven.repository(
            &quot;https://some.private.maven.re/po&quot;,
            user = &quot;johndoe&quot;,
            password = &quot;example-password&quot;
        ),
        &quot;https://repo1.maven.org/maven2&quot;,
        ...
    ],
)"><pre><span class="pl-en">load</span>(<span class="pl-s">"@rules_jvm_external//:defs.bzl"</span>, <span class="pl-s">"artifact"</span>)
<span class="pl-en">load</span>(<span class="pl-s">"@rules_jvm_external//:specs.bzl"</span>, <span class="pl-s">"maven"</span>)

<span class="pl-en">maven_install</span>(
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-s1">maven</span>.<span class="pl-c1">artifact</span>(
            <span class="pl-s1">group</span> <span class="pl-c1">=</span> <span class="pl-s">"com.google.guava"</span>,
            <span class="pl-s1">artifact</span> <span class="pl-c1">=</span> <span class="pl-s">"guava"</span>,
            <span class="pl-s1">version</span> <span class="pl-c1">=</span> <span class="pl-s">"27.0-android"</span>,
            <span class="pl-s1">exclusions</span> <span class="pl-c1">=</span> [
                ...
            ]
        ),
        <span class="pl-s">"junit:junit:4.12"</span>,
        ...
    ],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [
        <span class="pl-s1">maven</span>.<span class="pl-c1">repository</span>(
            <span class="pl-s">"https://some.private.maven.re/po"</span>,
            <span class="pl-s1">user</span> <span class="pl-c1">=</span> <span class="pl-s">"johndoe"</span>,
            <span class="pl-s1">password</span> <span class="pl-c1">=</span> <span class="pl-s">"example-password"</span>
        ),
        <span class="pl-s">"https://repo1.maven.org/maven2"</span>,
        ...
    ],
)</pre></div>
<p dir="auto">Note <a href="docs/bzlmod.md">when using <code>bzlmod</code></a> the syntax in <code>MODULE.bazel</code> is
different than shown above.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Artifact exclusion</h3><a id="user-content-artifact-exclusion" class="anchor" aria-label="Permalink: Artifact exclusion" href="#artifact-exclusion"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">If you want to exclude an artifact from the transitive closure of a top level
artifact, specify its <code>group-id:artifact-id</code> in the <code>exclusions</code> attribute of
the <code>maven.artifact</code> helper:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="load(&quot;@rules_jvm_external//:specs.bzl&quot;, &quot;maven&quot;)

maven_install(
    artifacts = [
        maven.artifact(
            group = &quot;com.google.guava&quot;,
            artifact = &quot;guava&quot;,
            version = &quot;27.0-jre&quot;,
            exclusions = [
                maven.exclusion(
                    group = &quot;org.codehaus.mojo&quot;,
                    artifact = &quot;animal-sniffer-annotations&quot;
                ),
                &quot;com.google.j2objc:j2objc-annotations&quot;,
            ]
        ),
        # ...
    ],
    repositories = [
        # ...
    ],
)"><pre><span class="pl-en">load</span>(<span class="pl-s">"@rules_jvm_external//:specs.bzl"</span>, <span class="pl-s">"maven"</span>)

<span class="pl-en">maven_install</span>(
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-s1">maven</span>.<span class="pl-c1">artifact</span>(
            <span class="pl-s1">group</span> <span class="pl-c1">=</span> <span class="pl-s">"com.google.guava"</span>,
            <span class="pl-s1">artifact</span> <span class="pl-c1">=</span> <span class="pl-s">"guava"</span>,
            <span class="pl-s1">version</span> <span class="pl-c1">=</span> <span class="pl-s">"27.0-jre"</span>,
            <span class="pl-s1">exclusions</span> <span class="pl-c1">=</span> [
                <span class="pl-s1">maven</span>.<span class="pl-c1">exclusion</span>(
                    <span class="pl-s1">group</span> <span class="pl-c1">=</span> <span class="pl-s">"org.codehaus.mojo"</span>,
                    <span class="pl-s1">artifact</span> <span class="pl-c1">=</span> <span class="pl-s">"animal-sniffer-annotations"</span>
                ),
                <span class="pl-s">"com.google.j2objc:j2objc-annotations"</span>,
            ]
        ),
        <span class="pl-c"># ...</span>
    ],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># ...</span>
    ],
)</pre></div>
<p dir="auto">You can specify the exclusion using either the <code>maven.exclusion</code> helper or the
<code>group-id:artifact-id</code> string directly.</p>
<p dir="auto">You can also exclude artifacts globally using the <code>excluded_artifacts</code>
attribute in <code>maven_install</code>:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven_install(
    artifacts = [
        # ...
    ],
    repositories = [
        # ...
    ],
    excluded_artifacts = [
        &quot;com.google.guava:guava&quot;,
    ],
)"><pre><span class="pl-en">maven_install</span>(
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># ...</span>
    ],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># ...</span>
    ],
    <span class="pl-s1">excluded_artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"com.google.guava:guava"</span>,
    ],
)</pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Compile-only dependencies</h3><a id="user-content-compile-only-dependencies" class="anchor" aria-label="Permalink: Compile-only dependencies" href="#compile-only-dependencies"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">If you want to mark certain artifacts as compile-only dependencies, use the
<code>neverlink</code> attribute in the <code>maven.artifact</code> helper:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="load(&quot;@rules_jvm_external//:specs.bzl&quot;, &quot;maven&quot;)

maven_install(
    artifacts = [
        maven.artifact(&quot;com.squareup&quot;, &quot;javapoet&quot;, &quot;1.11.0&quot;, neverlink = True),
    ],
    # ...
)"><pre><span class="pl-en">load</span>(<span class="pl-s">"@rules_jvm_external//:specs.bzl"</span>, <span class="pl-s">"maven"</span>)

<span class="pl-en">maven_install</span>(
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-s1">maven</span>.<span class="pl-c1">artifact</span>(<span class="pl-s">"com.squareup"</span>, <span class="pl-s">"javapoet"</span>, <span class="pl-s">"1.11.0"</span>, <span class="pl-s1">neverlink</span> <span class="pl-c1">=</span> <span class="pl-c1">True</span>),
    ],
    <span class="pl-c"># ...</span>
)</pre></div>
<p dir="auto">This instructs <code>rules_jvm_external</code> to mark the generated target for
<code>com.squareup:javapoet</code> with the <code>neverlink = True</code> attribute, making the
artifact available only for compilation and not at runtime.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Test-only dependencies</h3><a id="user-content-test-only-dependencies" class="anchor" aria-label="Permalink: Test-only dependencies" href="#test-only-dependencies"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">If you want to mark certain artifacts as test-only dependencies, use the
<code>testonly</code> attribute in the <code>maven.artifact</code> helper:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="load(&quot;@rules_jvm_external//:specs.bzl&quot;, &quot;maven&quot;)

maven_install(
    artifacts = [
        maven.artifact(&quot;junit&quot;, &quot;junit&quot;, &quot;4.13&quot;, testonly = True),
    ],
    # ...
)"><pre><span class="pl-en">load</span>(<span class="pl-s">"@rules_jvm_external//:specs.bzl"</span>, <span class="pl-s">"maven"</span>)

<span class="pl-en">maven_install</span>(
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-s1">maven</span>.<span class="pl-c1">artifact</span>(<span class="pl-s">"junit"</span>, <span class="pl-s">"junit"</span>, <span class="pl-s">"4.13"</span>, <span class="pl-s1">testonly</span> <span class="pl-c1">=</span> <span class="pl-c1">True</span>),
    ],
    <span class="pl-c"># ...</span>
)</pre></div>
<p dir="auto">This instructs <code>rules_jvm_external</code> to mark the generated target for
<code>junit:Junit</code> with the <code>testonly = True</code> attribute, making the
artifact available only for tests (e.g. <code>java_test</code>), or targets specifically
marked as <code>testonly = True</code>.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Resolving user-specified and transitive dependency version conflicts</h3><a id="user-content-resolving-user-specified-and-transitive-dependency-version-conflicts" class="anchor" aria-label="Permalink: Resolving user-specified and transitive dependency version conflicts" href="#resolving-user-specified-and-transitive-dependency-version-conflicts"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Use the <code>version_conflict_policy</code> attribute to decide how to resolve conflicts
between artifact versions specified in your <code>maven_install</code> rule and those
implicitly picked up as transitive dependencies.</p>
<p dir="auto">The attribute value can be either <code>default</code> or <code>pinned</code>.</p>
<p dir="auto"><code>default</code>: use <a href="https://get-coursier.io/docs/other-version-handling" rel="nofollow">Coursier's default algorithm</a>
for version handling.</p>
<p dir="auto"><code>pinned</code>: pin the versions of the artifacts that are explicitly specified in <code>maven_install</code>.</p>
<p dir="auto">For example, pulling in guava transitively via google-cloud-storage resolves to
guava-26.0-android.</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven_install(
    name = &quot;pinning&quot;,
    artifacts = [
        &quot;com.google.cloud:google-cloud-storage:1.66.0&quot;,
    ],
    repositories = [
        &quot;https://repo1.maven.org/maven2&quot;,
    ]
)"><pre><span class="pl-en">maven_install</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"pinning"</span>,
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"com.google.cloud:google-cloud-storage:1.66.0"</span>,
    ],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"https://repo1.maven.org/maven2"</span>,
    ]
)</pre></div>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="$ bazel query @pinning//:all | grep guava_guava
@pinning//:com_google_guava_guava
@pinning//:com_google_guava_guava_26_0_android"><pre class="notranslate"><code>$ bazel query @pinning//:all | grep guava_guava
@pinning//:com_google_guava_guava
@pinning//:com_google_guava_guava_26_0_android
</code></pre></div>
<p dir="auto">Pulling in guava-27.0-android directly works as expected.</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven_install(
    name = &quot;pinning&quot;,
    artifacts = [
        &quot;com.google.cloud:google-cloud-storage:1.66.0&quot;,
        &quot;com.google.guava:guava:27.0-android&quot;,
    ],
    repositories = [
        &quot;https://repo1.maven.org/maven2&quot;,
    ]
)"><pre><span class="pl-en">maven_install</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"pinning"</span>,
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"com.google.cloud:google-cloud-storage:1.66.0"</span>,
        <span class="pl-s">"com.google.guava:guava:27.0-android"</span>,
    ],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"https://repo1.maven.org/maven2"</span>,
    ]
)</pre></div>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="$ bazel query @pinning//:all | grep guava_guava
@pinning//:com_google_guava_guava
@pinning//:com_google_guava_guava_27_0_android"><pre class="notranslate"><code>$ bazel query @pinning//:all | grep guava_guava
@pinning//:com_google_guava_guava
@pinning//:com_google_guava_guava_27_0_android
</code></pre></div>
<p dir="auto">Pulling in guava-25.0-android (a lower version), resolves to guava-26.0-android. This is the default version conflict policy in action, where artifacts are resolved to the highest version.</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven_install(
    name = &quot;pinning&quot;,
    artifacts = [
        &quot;com.google.cloud:google-cloud-storage:1.66.0&quot;,
        &quot;com.google.guava:guava:25.0-android&quot;,
    ],
    repositories = [
        &quot;https://repo1.maven.org/maven2&quot;,
    ]
)"><pre><span class="pl-en">maven_install</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"pinning"</span>,
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"com.google.cloud:google-cloud-storage:1.66.0"</span>,
        <span class="pl-s">"com.google.guava:guava:25.0-android"</span>,
    ],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"https://repo1.maven.org/maven2"</span>,
    ]
)</pre></div>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="$ bazel query @pinning//:all | grep guava_guava
@pinning//:com_google_guava_guava
@pinning//:com_google_guava_guava_26_0_android"><pre class="notranslate"><code>$ bazel query @pinning//:all | grep guava_guava
@pinning//:com_google_guava_guava
@pinning//:com_google_guava_guava_26_0_android
</code></pre></div>
<p dir="auto">Now, if we add <code>version_conflict_policy = "pinned"</code>, we should see guava-25.0-android getting pulled instead. The rest of non-specified artifacts still resolve to the highest version in the case of version conflicts.</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven_install(
    name = &quot;pinning&quot;,
    artifacts = [
        &quot;com.google.cloud:google-cloud-storage:1.66.0&quot;,
        &quot;com.google.guava:guava:25.0-android&quot;,
    ],
    repositories = [
        &quot;https://repo1.maven.org/maven2&quot;,
    ]
    version_conflict_policy = &quot;pinned&quot;,
)"><pre><span class="pl-en">maven_install</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"pinning"</span>,
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"com.google.cloud:google-cloud-storage:1.66.0"</span>,
        <span class="pl-s">"com.google.guava:guava:25.0-android"</span>,
    ],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"https://repo1.maven.org/maven2"</span>,
    ]
    <span class="pl-s1">version_conflict_policy</span> <span class="pl-c1">=</span> <span class="pl-s">"pinned"</span>,
)</pre></div>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="$ bazel query @pinning//:all | grep guava_guava
@pinning//:com_google_guava_guava
@pinning//:com_google_guava_guava_25_0_android"><pre class="notranslate"><code>$ bazel query @pinning//:all | grep guava_guava
@pinning//:com_google_guava_guava
@pinning//:com_google_guava_guava_25_0_android
</code></pre></div>
<p dir="auto">There may be cases where you want the <code>default</code> pinning strategy, but
want one specific dependency to be pinned, no matter what. In these
cases, you can use the <code>force_version</code> attribute on the
<code>maven.artifact</code> helper to ensure this happens.</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven_install(
    name = &quot;forcing_versions&quot;,
    artifacts = [
        # Specify an ancient version of guava, and force its use. If we try to use `[23.3-jre]` as the version,
        # the resolution will fail when using `coursier`
        maven.artifact(
            artifact = &quot;guava&quot;,
            force_version = True,
            group = &quot;com.google.guava&quot;,
            version = &quot;23.3-jre&quot;,
        ),
        # And something that depends on a more recent version of guava
        &quot;xyz.rogfam:littleproxy:2.1.0&quot;,
    ],
    repositories = [
        &quot;https://repo1.maven.org/maven2&quot;,
    ],
)"><pre><span class="pl-en">maven_install</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"forcing_versions"</span>,
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># Specify an ancient version of guava, and force its use. If we try to use `[23.3-jre]` as the version,</span>
        <span class="pl-c"># the resolution will fail when using `coursier`</span>
        <span class="pl-s1">maven</span>.<span class="pl-c1">artifact</span>(
            <span class="pl-s1">artifact</span> <span class="pl-c1">=</span> <span class="pl-s">"guava"</span>,
            <span class="pl-s1">force_version</span> <span class="pl-c1">=</span> <span class="pl-c1">True</span>,
            <span class="pl-s1">group</span> <span class="pl-c1">=</span> <span class="pl-s">"com.google.guava"</span>,
            <span class="pl-s1">version</span> <span class="pl-c1">=</span> <span class="pl-s">"23.3-jre"</span>,
        ),
        <span class="pl-c"># And something that depends on a more recent version of guava</span>
        <span class="pl-s">"xyz.rogfam:littleproxy:2.1.0"</span>,
    ],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"https://repo1.maven.org/maven2"</span>,
    ],
)</pre></div>
<p dir="auto">In this case, once pinning is complete, guava <code>23.3-jre</code> will be selected.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Overriding generated targets</h3><a id="user-content-overriding-generated-targets" class="anchor" aria-label="Permalink: Overriding generated targets" href="#overriding-generated-targets"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">When are using a WORKSPACE file you can override the generated targets for
artifacts with a target label of your choice. For instance, if you want to
provide your own definition of <code>@maven//:com_google_guava_guava</code> at
<code>//third_party/guava:guava</code>, specify the mapping in the <code>override_targets</code>
attribute:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven_install(
    name = &quot;pinning&quot;,
    artifacts = [
        &quot;com.google.guava:guava:27.0-jre&quot;,
    ],
    repositories = [
        &quot;https://repo1.maven.org/maven2&quot;,
    ],
    override_targets = {
        &quot;com.google.guava:guava&quot;: &quot;@//third_party/guava:guava&quot;,
    },
)"><pre><span class="pl-en">maven_install</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"pinning"</span>,
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"com.google.guava:guava:27.0-jre"</span>,
    ],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"https://repo1.maven.org/maven2"</span>,
    ],
    <span class="pl-s1">override_targets</span> <span class="pl-c1">=</span> {
        <span class="pl-s">"com.google.guava:guava"</span>: <span class="pl-s">"@//third_party/guava:guava"</span>,
    },
)</pre></div>
<p dir="auto">When you are using bzlmod you can override the generated target with</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="maven.override(
    name = &quot;maven&quot;,
    coordinates = &quot;com.google.guava:guava&quot;,
    target = &quot;//third_party/guava:guava&quot;,
)"><pre class="notranslate"><code>maven.override(
    name = "maven",
    coordinates = "com.google.guava:guava",
    target = "//third_party/guava:guava",
)
</code></pre></div>
<p dir="auto">Note that the target label contains <code>@//</code>, which tells Bazel to reference the
target relative to your main workspace, instead of the <code>@maven</code> workspace.</p>
<p dir="auto">The dependency that has been overridden is made available prefixed with
<code>original_</code>. That is, in the example above, the version of Guava that was
resolved could be accessed as <code>@maven//:original_com_google_guava_guava</code>.
The primary use case this is designed to support is to allow specific
targets to have additional dependencies added (eg. to ensure a default
implementation of key interfaces are available on the classpath without
needing to modify every target)</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Proxies</h3><a id="user-content-proxies" class="anchor" aria-label="Permalink: Proxies" href="#proxies"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">As with other Bazel repository rules, the standard <code>http_proxy</code>, <code>https_proxy</code>
and <code>no_proxy</code> environment variables (and their uppercase counterparts) are
supported.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Repository aliases</h3><a id="user-content-repository-aliases" class="anchor" aria-label="Permalink: Repository aliases" href="#repository-aliases"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Maven artifact rules like <code>maven_jar</code> and <code>jvm_import_external</code> generate targets
labels in the form of <code>@group_artifact//jar</code>, like <code>@com_google_guava_guava//jar</code>. This
is different from the <code>@maven//:group_artifact</code> naming style used in this project.</p>
<p dir="auto">As some Bazel projects depend on the <code>@group_artifact//jar</code> style labels, we
provide a <code>generate_compat_repositories</code> attribute in <code>maven_install</code>. If
enabled, JAR artifacts can also be referenced using the <code>@group_artifact//jar</code>
target label. For example, <code>@maven//:com_google_guava_guava</code> can also be
referenced using <code>@com_google_guava_guava//jar</code>.</p>
<p dir="auto">The artifacts can also be referenced using the style used by
<code>java_import_external</code> as <code>@group_artifact//:group_artifact</code> or
<code>@group_artifact</code> for short.</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven_install(
    artifacts = [
        # ...
    ],
    repositories = [
        # ...
    ],
    generate_compat_repositories = True
)

load(&quot;@maven//:compat.bzl&quot;, &quot;compat_repositories&quot;)
compat_repositories()"><pre><span class="pl-en">maven_install</span>(
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># ...</span>
    ],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># ...</span>
    ],
    <span class="pl-s1">generate_compat_repositories</span> <span class="pl-c1">=</span> <span class="pl-c1">True</span>
)

<span class="pl-en">load</span>(<span class="pl-s">"@maven//:compat.bzl"</span>, <span class="pl-s">"compat_repositories"</span>)
<span class="pl-en">compat_repositories</span>()</pre></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Repository remapping</h4><a id="user-content-repository-remapping" class="anchor" aria-label="Permalink: Repository remapping" href="#repository-remapping"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">If the <code>maven_jar</code> or <code>jvm_import_external</code> is not named according to <code>rules_jvm_external</code>'s
conventions, you can apply
<a href="https://docs.bazel.build/versions/master/external.html#shadowing-dependencies" rel="nofollow">repository remapping</a>
from the expected name to the new name for compatibility.</p>
<p dir="auto">For example, if an external dependency uses <code>@guava//jar</code>, and <code>rules_jvm_external</code>
generates <code>@com_google_guava_guava//jar</code>, apply the <code>repo_mapping</code> attribute to the external
repository WORKSPACE rule, like <code>http_archive</code> in this example:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="http_archive(
    name = &quot;my_dep&quot;,
    repo_mapping = {
        &quot;@guava&quot;: &quot;@com_google_guava_guava&quot;,
    }
    # ...
)"><pre><span class="pl-en">http_archive</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"my_dep"</span>,
    <span class="pl-s1">repo_mapping</span> <span class="pl-c1">=</span> {
        <span class="pl-s">"@guava"</span>: <span class="pl-s">"@com_google_guava_guava"</span>,
    }
    <span class="pl-c"># ...</span>
)</pre></div>
<p dir="auto">With <code>repo_mapping</code>, all references to <code>@guava//jar</code> in <code>@my_dep</code>'s BUILD files will be mapped
to <code>@com_google_guava_guava//jar</code> instead.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Hiding transitive dependencies</h3><a id="user-content-hiding-transitive-dependencies" class="anchor" aria-label="Permalink: Hiding transitive dependencies" href="#hiding-transitive-dependencies"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">As a convenience, transitive dependencies are visible to your build rules.
However, this can lead to surprises when updating <code>maven_install</code>'s <code>artifacts</code>
list, since doing so may eliminate transitive dependencies from the build
graph.  To force rule authors to explicitly declare all directly referenced
artifacts, use the <code>strict_visibility</code> attribute in <code>maven_install</code>:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven_install(
    artifacts = [
        # ...
    ],
    repositories = [
        # ...
    ],
    strict_visibility = True
)"><pre><span class="pl-en">maven_install</span>(
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># ...</span>
    ],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># ...</span>
    ],
    <span class="pl-s1">strict_visibility</span> <span class="pl-c1">=</span> <span class="pl-c1">True</span>
)</pre></div>
<p dir="auto">It is also possible to change strict visibility value from default <code>//visibility:private</code>
to a value specified by <code>strict_visibility_value</code> attribute.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Accessing transitive dependencies list</h3><a id="user-content-accessing-transitive-dependencies-list" class="anchor" aria-label="Permalink: Accessing transitive dependencies list" href="#accessing-transitive-dependencies-list"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">It is possible to retrieve full list of dependencies in the dependency tree, including
transitive, source, javadoc and other artifacts. <code>maven_artifacts</code> list contains full
versioned maven coordinate strings of all dependencies.</p>
<p dir="auto">For example:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="load(&quot;@maven//:defs.bzl&quot;, &quot;maven_artifacts&quot;)

load(&quot;@rules_jvm_external//:defs.bzl&quot;, &quot;artifact&quot;)
load(&quot;@rules_jvm_external//:specs.bzl&quot;, &quot;parse&quot;)

all_jar_coordinates = [c for c in maven_artifacts if parse.parse_maven_coordinate(c).get(&quot;packaging&quot;, &quot;jar&quot;) == &quot;jar&quot;]
all_jar_targets = [artifact(c) for c in all_jar_coordinates]

java_library(
  name = &quot;depends_on_everything&quot;,
  runtime_deps = all_jar_targets,
)"><pre><span class="pl-en">load</span>(<span class="pl-s">"@maven//:defs.bzl"</span>, <span class="pl-s">"maven_artifacts"</span>)

<span class="pl-en">load</span>(<span class="pl-s">"@rules_jvm_external//:defs.bzl"</span>, <span class="pl-s">"artifact"</span>)
<span class="pl-en">load</span>(<span class="pl-s">"@rules_jvm_external//:specs.bzl"</span>, <span class="pl-s">"parse"</span>)

<span class="pl-s1">all_jar_coordinates</span> <span class="pl-c1">=</span> [<span class="pl-s1">c</span> <span class="pl-k">for</span> <span class="pl-s1">c</span> <span class="pl-c1">in</span> <span class="pl-s1">maven_artifacts</span> <span class="pl-k">if</span> <span class="pl-s1">parse</span>.<span class="pl-c1">parse_maven_coordinate</span>(<span class="pl-s1">c</span>).<span class="pl-c1">get</span>(<span class="pl-s">"packaging"</span>, <span class="pl-s">"jar"</span>) <span class="pl-c1">==</span> <span class="pl-s">"jar"</span>]
<span class="pl-s1">all_jar_targets</span> <span class="pl-c1">=</span> [<span class="pl-en">artifact</span>(<span class="pl-s1">c</span>) <span class="pl-k">for</span> <span class="pl-s1">c</span> <span class="pl-c1">in</span> <span class="pl-s1">all_jar_coordinates</span>]

<span class="pl-en">java_library</span>(
  <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"depends_on_everything"</span>,
  <span class="pl-s1">runtime_deps</span> <span class="pl-c1">=</span> <span class="pl-s1">all_jar_targets</span>,
)</pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Fetch and resolve timeout</h3><a id="user-content-fetch-and-resolve-timeout" class="anchor" aria-label="Permalink: Fetch and resolve timeout" href="#fetch-and-resolve-timeout"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The default timeout to fetch and resolve artifacts is 600 seconds.  If you need
to change this to resolve a large number of artifacts you can set the
<code>resolve_timeout</code> attribute in <code>maven_install</code>:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven_install(
    artifacts = [
        # ...
    ],
    repositories = [
        # ...
    ],
    resolve_timeout = 900
)"><pre><span class="pl-en">maven_install</span>(
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># ...</span>
    ],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># ...</span>
    ],
    <span class="pl-s1">resolve_timeout</span> <span class="pl-c1">=</span> <span class="pl-c1">900</span>
)</pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Ignoring empty jars</h3><a id="user-content-ignoring-empty-jars" class="anchor" aria-label="Permalink: Ignoring empty jars" href="#ignoring-empty-jars"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">By default, if any fetched jar is empty (has 0 bytes) the corresponding artifact will still be included in the dependency tree.</p>
<p dir="auto">If you would like to avoid such artifacts, and treat jars that are empty (i.e. their checksum equals the checksum of an
empty file) as if they were not found, you can set the <code>ignore_empty_files</code> attribute in <code>maven_install</code> to remove such
artifacts from coursier's output:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven_install(
    artifacts = [
        # ...
    ],
    repositories = [
        # ...
    ],
    # ...
    ignore_empty_files = True
)"><pre><span class="pl-en">maven_install</span>(
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># ...</span>
    ],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># ...</span>
    ],
    <span class="pl-c"># ...</span>
    <span class="pl-s1">ignore_empty_files</span> <span class="pl-c1">=</span> <span class="pl-c1">True</span>
)</pre></div>
<p dir="auto">This option may be useful if you see empty source jars when <code>fetch_sources</code> is enabled.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Duplicate artifact warning</h3><a id="user-content-duplicate-artifact-warning" class="anchor" aria-label="Permalink: Duplicate artifact warning" href="#duplicate-artifact-warning"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">By default you will be warned if there are duplicate artifacts in your artifact list. The <code>duplicate_version_warning</code> setting can be used to change this behavior. Use "none" to disable the warning and "error" to fail the build instead of warn.</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="maven_install(
    artifacts = [
        # ...
    ],
    repositories = [
        # ...
    ],
    duplicate_version_warning = &quot;error&quot;
)"><pre><span class="pl-en">maven_install</span>(
    <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># ...</span>
    ],
    <span class="pl-s1">repositories</span> <span class="pl-c1">=</span> [
        <span class="pl-c"># ...</span>
    ],
    <span class="pl-s1">duplicate_version_warning</span> <span class="pl-c1">=</span> <span class="pl-s">"error"</span>
)</pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Provide JVM options for artifact resolution</h3><a id="user-content-provide-jvm-options-for-artifact-resolution" class="anchor" aria-label="Permalink: Provide JVM options for artifact resolution" href="#provide-jvm-options-for-artifact-resolution"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">You can set the <code>JDK_JAVA_OPTIONS</code> environment variable to provide additional JVM options to the artifact resolver.</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="build --repo_env=JDK_JAVA_OPTIONS=-Djavax.net.ssl.trustStore=&lt;path-to-cacerts&gt;"><pre><span class="pl-s1">build</span> <span class="pl-c1">-</span><span class="pl-c1">-</span><span class="pl-s1">repo_env</span><span class="pl-c1">=</span><span class="pl-c1">JDK_JAVA_OPTIONS</span><span class="pl-c1">=</span><span class="pl-c1">-</span><span class="pl-v">Djavax</span>.<span class="pl-c1">net</span>.<span class="pl-c1">ssl</span>.<span class="pl-c1">trustStore</span><span class="pl-c1">=</span><span class="pl-c1">&lt;</span><span class="pl-s1">path</span><span class="pl-c1">-</span><span class="pl-s1">to</span><span class="pl-c1">-</span><span class="pl-s1">cacerts</span><span class="pl-c1">&gt;</span></pre></div>
<p dir="auto">can be added to your .bazelrc file if you need to specify custom cacerts for artifact resolution.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Provide JVM options for Coursier with <code>COURSIER_OPTS</code></h3><a id="user-content-provide-jvm-options-for-coursier-with-coursier_opts" class="anchor" aria-label="Permalink: Provide JVM options for Coursier with COURSIER_OPTS" href="#provide-jvm-options-for-coursier-with-coursier_opts"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">You can set up <code>COURSIER_OPTS</code> environment variable to provide some additional JVM options for Coursier.
This is a space-separated list of options.</p>
<p dir="auto">Assume you'd like to override Coursier's memory settings:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="COURSIER_OPTS=&quot;-Xms1g -Xmx4g&quot;"><pre>COURSIER_OPTS=<span class="pl-s"><span class="pl-pds">"</span>-Xms1g -Xmx4g<span class="pl-pds">"</span></span></pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Resolving issues with nonstandard system default JDKs</h3><a id="user-content-resolving-issues-with-nonstandard-system-default-jdks" class="anchor" aria-label="Permalink: Resolving issues with nonstandard system default JDKs" href="#resolving-issues-with-nonstandard-system-default-jdks"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Try to use OpenJDK explicitly if your machine or environment is set up to use a non-standard default implementation of the JDK and you encounter errors similar to the following:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="java.lang.NullPointerException
	at java.base/jdk.internal.reflect.UnsafeFieldAccessorImpl.ensureObj(UnsafeFieldAccessorImpl.java:58)
	at java.base/jdk.internal.reflect.UnsafeObjectFieldAccessorImpl.get(UnsafeObjectFieldAccessorImpl.java:36)
	at java.base/java.lang.reflect.Field.get(Field.java:418)
	at org.robolectric.shadows.ShadowActivityThread$_ActivityThread_$$Reflector0.getActivities(Unknown Source)
	at org.robolectric.shadows.ShadowActivityThread.reset(ShadowActivityThread.java:277)
	at org.robolectric.Shadows.reset(Shadows.java:2499)
	at org.robolectric.android.internal.AndroidTestEnvironment.resetState(AndroidTestEnvironment.java:640)
	at org.robolectric.RobolectricTestRunner.lambda$finallyAfterTest$0(RobolectricTestRunner.java:361)
	at org.robolectric.util.PerfStatsCollector.measure(PerfStatsCollector.java:86)
	at org.robolectric.RobolectricTestRunner.finallyAfterTest(RobolectricTestRunner.java:359)
	at org.robolectric.internal.SandboxTestRunner$2.lambda$evaluate$2(SandboxTestRunner.java:296)
	at org.robolectric.internal.bytecode.Sandbox.lambda$runOnMainThread$0(Sandbox.java:99)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:830)"><pre class="notranslate"><code>java.lang.NullPointerException
	at java.base/jdk.internal.reflect.UnsafeFieldAccessorImpl.ensureObj(UnsafeFieldAccessorImpl.java:58)
	at java.base/jdk.internal.reflect.UnsafeObjectFieldAccessorImpl.get(UnsafeObjectFieldAccessorImpl.java:36)
	at java.base/java.lang.reflect.Field.get(Field.java:418)
	at org.robolectric.shadows.ShadowActivityThread$_ActivityThread_$$Reflector0.getActivities(Unknown Source)
	at org.robolectric.shadows.ShadowActivityThread.reset(ShadowActivityThread.java:277)
	at org.robolectric.Shadows.reset(Shadows.java:2499)
	at org.robolectric.android.internal.AndroidTestEnvironment.resetState(AndroidTestEnvironment.java:640)
	at org.robolectric.RobolectricTestRunner.lambda$finallyAfterTest$0(RobolectricTestRunner.java:361)
	at org.robolectric.util.PerfStatsCollector.measure(PerfStatsCollector.java:86)
	at org.robolectric.RobolectricTestRunner.finallyAfterTest(RobolectricTestRunner.java:359)
	at org.robolectric.internal.SandboxTestRunner$2.lambda$evaluate$2(SandboxTestRunner.java:296)
	at org.robolectric.internal.bytecode.Sandbox.lambda$runOnMainThread$0(Sandbox.java:99)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:830)
</code></pre></div>
<p dir="auto">or</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="java.lang.UnsatisfiedLinkError: libstdc++.so.6: cannot open shared object file: No such file or directory
	at java.base/java.lang.ClassLoader$NativeLibrary.load0(Native Method)
	at java.base/java.lang.ClassLoader$NativeLibrary.load(ClassLoader.java:2444)
	at java.base/java.lang.ClassLoader$NativeLibrary.loadLibrary(ClassLoader.java:2500)
	at java.base/java.lang.ClassLoader.loadLibrary0(ClassLoader.java:2716)
	at java.base/java.lang.ClassLoader.loadLibrary(ClassLoader.java:2629)
	at java.base/java.lang.Runtime.load0(Runtime.java:769)
	at java.base/java.lang.System.load(System.java:1840)
	at org.conscrypt.NativeLibraryUtil.loadLibrary(NativeLibraryUtil.java:52)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
  ..."><pre class="notranslate"><code>java.lang.UnsatisfiedLinkError: libstdc++.so.6: cannot open shared object file: No such file or directory
	at java.base/java.lang.ClassLoader$NativeLibrary.load0(Native Method)
	at java.base/java.lang.ClassLoader$NativeLibrary.load(ClassLoader.java:2444)
	at java.base/java.lang.ClassLoader$NativeLibrary.loadLibrary(ClassLoader.java:2500)
	at java.base/java.lang.ClassLoader.loadLibrary0(ClassLoader.java:2716)
	at java.base/java.lang.ClassLoader.loadLibrary(ClassLoader.java:2629)
	at java.base/java.lang.Runtime.load0(Runtime.java:769)
	at java.base/java.lang.System.load(System.java:1840)
	at org.conscrypt.NativeLibraryUtil.loadLibrary(NativeLibraryUtil.java:52)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
  ...
</code></pre></div>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Exporting and consuming artifacts from external repositories</h2><a id="user-content-exporting-and-consuming-artifacts-from-external-repositories" class="anchor" aria-label="Permalink: Exporting and consuming artifacts from external repositories" href="#exporting-and-consuming-artifacts-from-external-repositories"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">If you're writing a library that has dependencies, you should define a constant that
lists all of the artifacts that your library requires. For example:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# my_library/BUILD
# Public interface of the library
java_library(
  name = &quot;my_interface&quot;,
  deps = [
    &quot;@maven//:junit_junit&quot;,
    &quot;@maven//:com_google_inject_guice&quot;,
  ],
)"><pre><span class="pl-c"># my_library/BUILD</span>
<span class="pl-c"># Public interface of the library</span>
<span class="pl-en">java_library</span>(
  <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"my_interface"</span>,
  <span class="pl-s1">deps</span> <span class="pl-c1">=</span> [
    <span class="pl-s">"@maven//:junit_junit"</span>,
    <span class="pl-s">"@maven//:com_google_inject_guice"</span>,
  ],
)</pre></div>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# my_library/library_deps.bzl
# All artifacts required by the library
MY_LIBRARY_ARTIFACTS = [
  &quot;junit:junit:4.12&quot;,
  &quot;com.google.inject:guice:4.0&quot;,
]"><pre><span class="pl-c"># my_library/library_deps.bzl</span>
<span class="pl-c"># All artifacts required by the library</span>
<span class="pl-c1">MY_LIBRARY_ARTIFACTS</span> <span class="pl-c1">=</span> [
  <span class="pl-s">"junit:junit:4.12"</span>,
  <span class="pl-s">"com.google.inject:guice:4.0"</span>,
]</pre></div>
<p dir="auto">Users of your library can then load the constant in their <code>WORKSPACE</code> and add the
artifacts to their <code>maven_install</code>. For example:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# user_project/WORKSPACE
load(&quot;@my_library//:library_deps.bzl&quot;, &quot;MY_LIBRARY_ARTIFACTS&quot;)

maven_install(
  artifacts = [
        &quot;junit:junit:4.11&quot;,
        &quot;com.google.guava:guava:26.0-jre&quot;,
  ] + MY_LIBRARY_ARTIFACTS,
)"><pre><span class="pl-c"># user_project/WORKSPACE</span>
<span class="pl-en">load</span>(<span class="pl-s">"@my_library//:library_deps.bzl"</span>, <span class="pl-s">"MY_LIBRARY_ARTIFACTS"</span>)

<span class="pl-en">maven_install</span>(
  <span class="pl-s1">artifacts</span> <span class="pl-c1">=</span> [
        <span class="pl-s">"junit:junit:4.11"</span>,
        <span class="pl-s">"com.google.guava:guava:26.0-jre"</span>,
  ] <span class="pl-c1">+</span> <span class="pl-c1">MY_LIBRARY_ARTIFACTS</span>,
)</pre></div>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# user_project/BUILD
java_library(
  name = &quot;user_lib&quot;,
  deps = [
    &quot;@my_library//:my_interface&quot;,
    &quot;@maven//:junit_junit&quot;,
  ],
)"><pre><span class="pl-c"># user_project/BUILD</span>
<span class="pl-en">java_library</span>(
  <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"user_lib"</span>,
  <span class="pl-s1">deps</span> <span class="pl-c1">=</span> [
    <span class="pl-s">"@my_library//:my_interface"</span>,
    <span class="pl-s">"@maven//:junit_junit"</span>,
  ],
)</pre></div>
<p dir="auto">Any version conflicts or duplicate artifacts will resolved automatically.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Publishing to External Repositories</h2><a id="user-content-publishing-to-external-repositories" class="anchor" aria-label="Permalink: Publishing to External Repositories" href="#publishing-to-external-repositories"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">In order to publish an artifact from your repo to a maven repository, you
must first create a <code>java_export</code> target. This is similar to a regular
<code>java_library</code>, but allows two additional parameters: the maven coordinates
and an optional template file to use for the <code>pom.xml</code> file.</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# user_project/BUILD
load(&quot;@rules_jvm_external//:defs.bzl&quot;, &quot;java_export&quot;)

java_export(
  name = &quot;exported_lib&quot;,
  maven_coordinates = &quot;com.example:project:0.0.1&quot;,
  pom_template = &quot;pom.tmpl&quot;,  # You can omit this
  srcs = glob([&quot;*.java&quot;]),
  deps = [
    &quot;//user_project/utils&quot;,
    &quot;@maven//:com_google_guava_guava&quot;,
  ],
)"><pre><span class="pl-c"># user_project/BUILD</span>
<span class="pl-en">load</span>(<span class="pl-s">"@rules_jvm_external//:defs.bzl"</span>, <span class="pl-s">"java_export"</span>)

<span class="pl-en">java_export</span>(
  <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"exported_lib"</span>,
  <span class="pl-s1">maven_coordinates</span> <span class="pl-c1">=</span> <span class="pl-s">"com.example:project:0.0.1"</span>,
  <span class="pl-s1">pom_template</span> <span class="pl-c1">=</span> <span class="pl-s">"pom.tmpl"</span>,  <span class="pl-c"># You can omit this</span>
  <span class="pl-s1">srcs</span> <span class="pl-c1">=</span> <span class="pl-en">glob</span>([<span class="pl-s">"*.java"</span>]),
  <span class="pl-s1">deps</span> <span class="pl-c1">=</span> [
    <span class="pl-s">"//user_project/utils"</span>,
    <span class="pl-s">"@maven//:com_google_guava_guava"</span>,
  ],
)</pre></div>
<p dir="auto">If you wish to publish an artifact with Kotlin source code to a maven repository
you can use <code>kt_jvm_export</code>. This rule has the same arguments and generated
rules as <code>java_export</code>, but uses <code>kt_jvm_library</code> instead of <code>java_library</code>.</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# user_project/BUILD
load(&quot;@rules_jvm_external//:kt_defs.bzl&quot;, &quot;kt_jvm_export&quot;)

kt_jvm_export(
  name = &quot;exported_kt_lib&quot;,
  maven_coordinates = &quot;com.example:project:0.0.1&quot;,
  srcs = glob([&quot;*.kt&quot;]),
)"><pre><span class="pl-c"># user_project/BUILD</span>
<span class="pl-en">load</span>(<span class="pl-s">"@rules_jvm_external//:kt_defs.bzl"</span>, <span class="pl-s">"kt_jvm_export"</span>)

<span class="pl-en">kt_jvm_export</span>(
  <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"exported_kt_lib"</span>,
  <span class="pl-s1">maven_coordinates</span> <span class="pl-c1">=</span> <span class="pl-s">"com.example:project:0.0.1"</span>,
  <span class="pl-s1">srcs</span> <span class="pl-c1">=</span> <span class="pl-en">glob</span>([<span class="pl-s">"*.kt"</span>]),
)</pre></div>
<p dir="auto">In order to publish the artifact, use <code>bazel run</code>:</p>
<p dir="auto"><code>bazel run --define "maven_repo=file://$HOME/.m2/repository" //user_project:exported_lib.publish</code></p>
<p dir="auto">Or, to publish to (eg) Sonatype's OSS repo:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="MAVEN_USER=example_user MAVEN_PASSWORD=hunter2 bazel run --stamp \
  --define &quot;maven_repo=https://oss.sonatype.org/service/local/staging/deploy/maven2&quot; \
  --define gpg_sign=true \
  //user_project:exported_lib.publish`"><pre>MAVEN_USER=example_user MAVEN_PASSWORD=hunter2 bazel run --stamp \
  --define <span class="pl-s"><span class="pl-pds">"</span>maven_repo=https://oss.sonatype.org/service/local/staging/deploy/maven2<span class="pl-pds">"</span></span> \
  --define gpg_sign=true \
  //user_project:exported_lib.publish<span class="pl-s"><span class="pl-pds">`</span></span></pre></div>
<p dir="auto">Or, to publish to a Google Cloud Storage:</p>
<p dir="auto"><code>bazel run --define "maven_repo=gs://example-bucket/repository" //user_project:exported_lib.publish</code></p>
<p dir="auto">Or, to publish to an Amazon S3 bucket:</p>
<p dir="auto"><code>bazel run --define "maven_repo=s3://example-bucket/repository" //user_project:exported_lib.publish</code></p>
<p dir="auto">Or, to publish to a GCP Artifact Registry:</p>
<p dir="auto"><code>bazel run --define "maven_repo=artifactregistry://us-west1-maven.pkg.dev/project/repository" //user_project:exported_lib.publish</code></p>
<p dir="auto">When using the <code>gpg_sign</code> option, the current default key will be used for
signing, and the <code>gpg</code> binary needs to be installed on the machine.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Configuring the dependency resolver</h2><a id="user-content-configuring-the-dependency-resolver" class="anchor" aria-label="Permalink: Configuring the dependency resolver" href="#configuring-the-dependency-resolver"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><code>rules_jvm_external</code> supports different mechanisms for dependency resolution.
These can be selected using the <code>resolver</code> attribute of <code>maven_install</code>. The
default resolver is one backed by <a href="https://get-coursier.io" rel="nofollow">coursier</a>.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Common options</h3><a id="user-content-common-options" class="anchor" aria-label="Permalink: Common options" href="#common-options"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">All resolvers understand the following environment variables:</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Environment variable</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>RJE_VERBOSE</code></td>
<td>When set to <code>1</code> extra diagnostic logging will be sent to <code>stderr</code></td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Configuring Coursier</h3><a id="user-content-configuring-coursier" class="anchor" aria-label="Permalink: Configuring Coursier" href="#configuring-coursier"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The default resolver is backed by <a href="https://get-coursier.io" rel="nofollow">coursier</a>, which
is used in tools such as <a href="https://www.scala-sbt.org" rel="nofollow">sbt</a>. It supports being
used without a lock file, but cannot handle resolutions which require Maven
BOMs to be used. When using the coursier-backed resolver, the following
environment variables are honoured:</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Environment variable</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>COURSIER_CREDENTIALS</code></td>
<td><a href="https://get-coursier.io/docs/other-credentials#inline" rel="nofollow">Documented here</a> on the coursier site. If set to an absolute path, this will be used for configuring the credentials</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Configuring Maven</h3><a id="user-content-configuring-maven" class="anchor" aria-label="Permalink: Configuring Maven" href="#configuring-maven"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">A Maven-backed resolver can be used by using setting the <code>resolver</code>
attribute of <code>maven_install</code> to <code>maven</code>. This resolver requires the use of a
lock file. For bootstrapping purposes, this file may simply be an empty
file. When using the maven-backed resolver, the following environment
variables are honoured:</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Environment variable</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>RJE_ASSUME_PRESENT</code></td>
<td>Prevents the resolver from checking remote repositories to see if a dependency is present, and just assumes it is</td>
</tr>
<tr>
<td><code>RJE_MAX_THREADS</code></td>
<td>Integer giving the maximum number of threads to use <br>for downloads. The default value is whichever is lower: the number of processors on the machine, or 5</td>
</tr>
<tr>
<td><code>RJE_UNSAFE_CACHE</code></td>
<td>When set to <code>1</code> will use your <code>$HOME/.m2/repository</code> directory to speed up dependency resolution</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto">Using the unsafe cache option will use your local <code>$HOME/.m2/repository</code> as
a source for dependency resolutions, but will not include any local paths in
the generated lock file unless the <code>repositories</code> attribute contains <code>m2local</code>.</p>
<p dir="auto">The Maven-backed resolver will use credentials stored in a <code>$HOME/.netrc</code>
file when performing dependency resolution</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">IPv6 support</h2><a id="user-content-ipv6-support" class="anchor" aria-label="Permalink: IPv6 support" href="#ipv6-support"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Certain IPv4/IPv6 dual-stack environments may require flags to override the default settings for downloading dependencies, for both Bazel's native downloader and Coursier as a downloader:</p>
<p dir="auto">Add:</p>
<ul dir="auto">
<li><code>startup --host_jvm_args=-Djava.net.preferIPv6Addresses=true</code> to your <code>.bazelrc</code> file for Bazel's native downloader.</li>
<li><code>-Djava.net.preferIPv6Addresses=true to the </code>COURSIER_OPTS` environment variable to provide JVM options for Coursier.</li>
</ul>
<p dir="auto">For more information, read the <a href="https://bazel.build/docs/external#support-for-ipv6" rel="nofollow">official docs for IPv6 support in Bazel</a>.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Developing this project</h2><a id="user-content-developing-this-project" class="anchor" aria-label="Permalink: Developing this project" href="#developing-this-project"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Verbose / debug mode</h3><a id="user-content-verbose--debug-mode" class="anchor" aria-label="Permalink: Verbose / debug mode" href="#verbose--debug-mode"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Set the <code>RJE_VERBOSE</code> environment variable to <code>true</code> to print <code>coursier</code>'s verbose
output. For example:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="$ RJE_VERBOSE=true bazel run @maven//:pin"><pre class="notranslate"><code>$ RJE_VERBOSE=true bazel run @maven//:pin
</code></pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Tests</h3><a id="user-content-tests" class="anchor" aria-label="Permalink: Tests" href="#tests"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">In order to run tests, your system must have an Android SDK installed. You can install the Android SDK using <a href="https://developer.android.com/studio" rel="nofollow">Android Studio</a>, or through most system package managers.</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="$ bazel test //..."><pre class="notranslate"><code>$ bazel test //...
</code></pre></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Installing the Android SDK on macOS</h4><a id="user-content-installing-the-android-sdk-on-macos" class="anchor" aria-label="Permalink: Installing the Android SDK on macOS" href="#installing-the-android-sdk-on-macos"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The instructions for installing the Android SDK on macOS can be hard
to find, but if you're comfortable using <a href="https://brew.sh" rel="nofollow">HomeBrew</a>,
the following steps will install what you need and set up the
<code>ANDROID_HOME</code> environment variable that's required in order to run
<code>rules_jvm_external</code>'s own tests.</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="brew install android-commandlinetools
export ANDROID_HOME=&quot;$(brew --prefix)/share/android-commandlinetools&quot;
sdkmanager &quot;build-tools;33.0.1&quot; &quot;cmdline-tools;latest&quot; &quot;ndk;21.4.7075529&quot; &quot;platform-tools&quot; &quot;platforms;android-33&quot;
export ANDROID_NDK_HOME=&quot;$ANDROID_HOME/ndk/21.4.7075529&quot;"><pre class="notranslate"><code>brew install android-commandlinetools
export ANDROID_HOME="$(brew --prefix)/share/android-commandlinetools"
sdkmanager "build-tools;33.0.1" "cmdline-tools;latest" "ndk;21.4.7075529" "platform-tools" "platforms;android-33"
export ANDROID_NDK_HOME="$ANDROID_HOME/ndk/21.4.7075529"
</code></pre></div>
<p dir="auto">You can add the <code>export ANDROID_HOME</code> to your <code>.zshrc</code> or similar
config file.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Generating documentation</h3><a id="user-content-generating-documentation" class="anchor" aria-label="Permalink: Generating documentation" href="#generating-documentation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Use <a href="https://skydoc.bazel.build/docs/getting_started_stardoc.html" rel="nofollow">Stardoc</a> to
generate API documentation in the <a href="docs/">docs</a> directory using
<a href="scripts/generate_docs.sh">generate_docs.sh</a>.</p>
</article></div>