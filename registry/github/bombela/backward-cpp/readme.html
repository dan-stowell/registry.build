<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><div class="markdown-heading" dir="auto"><h1 class="heading-element" dir="auto">Backward-cpp <a href="https://conan.io/center/recipes/backward-cpp" rel="nofollow"><img src="https://camo.githubusercontent.com/a42c63f57fcbe1869e9657a41a5c24debe4f693477ea11090695411f9623e896/68747470733a2f2f696d672e736869656c64732e696f2f636f6e616e2f762f6261636b776172642d637070" alt="Conan Center" data-canonical-src="https://img.shields.io/conan/v/backward-cpp" style="max-width: 100%;"></a></h1><a id="user-content-backward-cpp-" class="anchor" aria-label="Permalink: Backward-cpp " href="#backward-cpp-"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Backward is a beautiful stack trace pretty printer for C++.</p>
<p dir="auto">If you are bored to see this:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="doc/rude.png"><img src="doc/rude.png" alt="default trace" style="max-width: 100%;"></a></p>
<p dir="auto">Backward will spice it up for you:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="doc/pretty.png"><img src="doc/pretty.png" alt="pretty stackstrace" style="max-width: 100%;"></a></p>
<p dir="auto">There is not much to say. Of course it will be able to display the code
snippets only if the source files are accessible (else see trace #4 in the
example).</p>
<p dir="auto">All "Source" lines and code snippet prefixed by a pipe "|" are frames inline
the next frame.
You can see that for the trace #1 in the example, the function
<code>you_shall_not_pass()</code> was inlined in the function <code>...read2::do_test()</code> by the
compiler.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Installation</h2><a id="user-content-installation" class="anchor" aria-label="Permalink: Installation" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Install backward.hpp</h4><a id="user-content-install-backwardhpp" class="anchor" aria-label="Permalink: Install backward.hpp" href="#install-backwardhpp"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Backward is a header only library. So installing Backward is easy, simply drop
a copy of <code>backward.hpp</code> along with your other source files in your C++ project.
You can also use a git submodule or really any other way that best fits your
environment, as long as you can include <code>backward.hpp</code>.</p>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Install backward.cpp</h4><a id="user-content-install-backwardcpp" class="anchor" aria-label="Permalink: Install backward.cpp" href="#install-backwardcpp"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">If you want Backward to automatically print a stack trace on most common fatal
errors (segfault, abort, un-handled exception...), simply add a copy of
<code>backward.cpp</code> to your project, and don't forget to tell your build system.</p>
<p dir="auto">The code in <code>backward.cpp</code> is trivial anyway, you can simply copy what it's
doing at your convenience.</p>
<p dir="auto">Note for <a href="https://github.com/facebook/folly">folly</a> library users: must define <code>backward::SignalHandling sh;</code> after <code>folly::init(&amp;argc, &amp;argv);</code>.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Configuration &amp; Dependencies</h2><a id="user-content-configuration--dependencies" class="anchor" aria-label="Permalink: Configuration &amp; Dependencies" href="#configuration--dependencies"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Integration with CMake</h3><a id="user-content-integration-with-cmake" class="anchor" aria-label="Permalink: Integration with CMake" href="#integration-with-cmake"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">If you are using CMake and want to use its configuration abilities to save you
the trouble, you can easily integrate Backward, depending on how you obtained
the library.</p>
<p dir="auto">Notice that all approaches are equivalent in the way Backward is added to a
CMake target, the difference is in how CMake is pointed to the Backward
sources. Backward defines three targets:</p>
<ul dir="auto">
<li><code>Backward::Interface</code> is an interface target that brings compiler definition
flags, include directory, and external libraries. This is all you need to use
the <code>backward.hpp</code> header library.</li>
<li><code>Backward::Object</code> brings <code>Backward::Interface</code> and <code>backward.cpp</code> as an
<code>OBJECT</code> CMake library. This target cannot be exported, so it is not
available when Backward is used via <code>find_package</code>.</li>
<li><code>Backward::Backward</code> brings <code>Backward::Interface</code> and <code>backward.cpp</code> as
either <code>STATIC</code> or <code>SHARED</code> library (depending on the <code>BACKWARD_SHARED</code>
option). This target is exported and always available, however note that the
linker will not include unused objects from a static library, unless the
<code>-Wl,--whole-archive</code> option (or similar) is used.</li>
</ul>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">With <code>FetchContent()</code>:</h4><a id="user-content-with-fetchcontent" class="anchor" aria-label="Permalink: With FetchContent():" href="#with-fetchcontent"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">If you are using a recent version of CMake, you can integrate <code>backward</code> via <code>FetchContent</code> like below:</p>
<div class="highlight highlight-source-cmake notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="include(FetchContent)

# Also requires one of: libbfd (gnu binutils), libdwarf, libdw (elfutils)
FetchContent_Declare(backward
    GIT_REPOSITORY https://github.com/bombela/backward-cpp
    GIT_TAG master  # or a version tag, such as v1.6
    SYSTEM          # optional, the Backward include directory will be treated as system directory
)
FetchContent_MakeAvailable(backward)

# Add Backward to your target (either Backward::Interface, Backward::Object, or Backward::Backward)
target_link_libraries(mytarget PUBLIC Backward::Interface)"><pre><span class="pl-k">include</span>(FetchContent)

<span class="pl-c"># Also requires one of: libbfd (gnu binutils), libdwarf, libdw (elfutils)</span>
FetchContent_Declare(backward
    GIT_REPOSITORY https://github.com/bombela/backward-cpp
    GIT_TAG master  <span class="pl-c"># or a version tag, such as v1.6</span>
    <span class="pl-c1">SYSTEM</span>          <span class="pl-c"># optional, the Backward include directory will be treated as system directory</span>
)
FetchContent_MakeAvailable(backward)

<span class="pl-c"># Add Backward to your target (either Backward::Interface, Backward::Object, or Backward::Backward)</span>
<span class="pl-k">target_link_libraries</span>(mytarget <span class="pl-e">PUBLIC</span> Backward::<span class="pl-e">Interface</span>)</pre></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">As a subdirectory:</h4><a id="user-content-as-a-subdirectory" class="anchor" aria-label="Permalink: As a subdirectory:" href="#as-a-subdirectory"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">In this case you have a subdirectory containing the whole repository of Backward
(e.g. using <a href="https://git-scm.com/book/en/v2/Git-Tools-Submodules" rel="nofollow">git-submodule</a>),
in this case you can do:</p>
<div class="highlight highlight-source-cmake notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="add_subdirectory(/path/to/backward-cpp)

# Add Backward to your target (either Backward::Interface, Backward::Object, or Backward::Backward)
target_link_libraries(mytarget PUBLIC Backward::Interface)"><pre><span class="pl-k">add_subdirectory</span>(/<span class="pl-k">path</span>/to/backward-cpp)

<span class="pl-c"># Add Backward to your target (either Backward::Interface, Backward::Object, or Backward::Backward)</span>
<span class="pl-k">target_link_libraries</span>(mytarget <span class="pl-e">PUBLIC</span> Backward::<span class="pl-e">Interface</span>)</pre></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Modifying <code>CMAKE_MODULE_PATH</code>:</h4><a id="user-content-modifying-cmake_module_path" class="anchor" aria-label="Permalink: Modifying CMAKE_MODULE_PATH:" href="#modifying-cmake_module_path"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">In this case you can have Backward installed as a subdirectory:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="list(APPEND CMAKE_MODULE_PATH /path/to/backward-cpp)
find_package(Backward)

# Add Backward to your target (either Backward::Interface or Backward::Backward)
target_link_libraries(mytarget PUBLIC Backward::Interface)"><pre class="notranslate"><code>list(APPEND CMAKE_MODULE_PATH /path/to/backward-cpp)
find_package(Backward)

# Add Backward to your target (either Backward::Interface or Backward::Backward)
target_link_libraries(mytarget PUBLIC Backward::Interface)
</code></pre></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Installation through a regular package manager</h4><a id="user-content-installation-through-a-regular-package-manager" class="anchor" aria-label="Permalink: Installation through a regular package manager" href="#installation-through-a-regular-package-manager"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">In this case you have obtained Backward through a package manager.</p>
<p dir="auto">Packages currently available:</p>
<ul dir="auto">
<li><a href="https://anaconda.org/conda-forge/backward-cpp" rel="nofollow">conda-forge</a></li>
</ul>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="find_package(Backward)

# Add Backward to your target (either Backward::Interface or Backward::Backward)
target_link_libraries(mytarget PUBLIC Backward::Interface)"><pre class="notranslate"><code>find_package(Backward)

# Add Backward to your target (either Backward::Interface or Backward::Backward)
target_link_libraries(mytarget PUBLIC Backward::Interface)
</code></pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Libraries to unwind the stack</h3><a id="user-content-libraries-to-unwind-the-stack" class="anchor" aria-label="Permalink: Libraries to unwind the stack" href="#libraries-to-unwind-the-stack"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">On Linux and macOS, backtrace can back-trace or "walk" the stack using the
following libraries:</p>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">unwind</h4><a id="user-content-unwind" class="anchor" aria-label="Permalink: unwind" href="#unwind"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Unwind comes from libgcc, but there is an equivalent inside clang itself. With
unwind, the stacktrace is as accurate as it can possibly be, since this is
used by the C++ runtine in gcc/clang for stack unwinding on exception.</p>
<p dir="auto">Normally libgcc is already linked to your program by default.</p>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">libunwind from the <a href="https://github.com/libunwind/libunwind">libunwind project</a></h4><a id="user-content-libunwind-from-the-libunwind-project" class="anchor" aria-label="Permalink: libunwind from the libunwind project" href="#libunwind-from-the-libunwind-project"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="apt-get install binutils-dev (or equivalent)"><pre class="notranslate"><code>apt-get install binutils-dev (or equivalent)
</code></pre></div>
<p dir="auto">Libunwind provides, in some cases, a more accurate stacktrace as it knows
to decode signal handler frames and lets us edit the context registers when
unwinding, allowing stack traces over bad function references.</p>
<p dir="auto">For best results make sure you are using libunwind 1.3 or later, which added
<code>unw_init_local2</code> and support for handling signal frames.</p>
<p dir="auto">CMake will warn you when configuring if your libunwind version doesn't support
signal frames.</p>
<p dir="auto">On macOS clang provides a libunwind API compatible library as part of its
environment, so no third party libraries are necessary.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Compile with debug info</h3><a id="user-content-compile-with-debug-info" class="anchor" aria-label="Permalink: Compile with debug info" href="#compile-with-debug-info"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">You need to compile your project with generation of debug symbols enabled,
usually <code>-g</code> with clang++ and g++.</p>
<p dir="auto">Note that you can use <code>-g</code> with any level of optimization, with modern debug
information encoding like DWARF, it only takes space in the binary (it's not
loaded in memory until your debugger or Backward makes use of it, don't worry),
and it doesn't impact the code generation (at least on GNU/Linux x86_64 for
what I know).</p>
<p dir="auto">If you are missing debug information, the stack trace will lack details about
your sources.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Libraries to read the debug info</h3><a id="user-content-libraries-to-read-the-debug-info" class="anchor" aria-label="Permalink: Libraries to read the debug info" href="#libraries-to-read-the-debug-info"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Backward supports pretty printed stack traces on GNU/Linux, macOS and Windows,
it will compile fine under other platforms but will not do anything. <strong>Pull
requests are welcome :)</strong></p>
<p dir="auto">Also, by default you will get a really basic stack trace, based on the
<code>backtrace_symbols</code> API:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="doc/nice.png"><img src="doc/nice.png" alt="default trace" style="max-width: 100%;"></a></p>
<p dir="auto">You will need to install some dependencies to get the ultimate stack trace.
Three libraries are currently supported, the only difference is which one is the
easiest for you to install, so pick your poison:</p>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">libbfd from the <a href="http://www.gnu.org/software/binutils/" rel="nofollow">GNU/binutils</a></h4><a id="user-content-libbfd-from-the-gnubinutils" class="anchor" aria-label="Permalink: libbfd from the GNU/binutils" href="#libbfd-from-the-gnubinutils"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="apt-get install binutils-dev (or equivalent)"><pre class="notranslate"><code>apt-get install binutils-dev (or equivalent)
</code></pre></div>
<p dir="auto">And do not forget to link with the lib: <code>g++/clang++ -lbfd -ldl ...</code></p>
<p dir="auto">This library requires dynamic loading. Which is provided by the library <code>dl</code>.
Hence why we also link with <code>-ldl</code>.</p>
<p dir="auto">Then define the following before every inclusion of <code>backward.hpp</code> (don't
forget to update <code>backward.cpp</code> as well):</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="#define BACKWARD_HAS_BFD 1"><pre class="notranslate"><code>#define BACKWARD_HAS_BFD 1
</code></pre></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">libdw from the <a href="https://fedorahosted.org/elfutils/" rel="nofollow">elfutils</a></h4><a id="user-content-libdw-from-the-elfutils" class="anchor" aria-label="Permalink: libdw from the elfutils" href="#libdw-from-the-elfutils"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="apt-get install libdw-dev (or equivalent)"><pre class="notranslate"><code>apt-get install libdw-dev (or equivalent)
</code></pre></div>
<p dir="auto">And do not forget to link with the lib and inform Backward to use it:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="#define BACKWARD_HAS_DW 1"><pre class="notranslate"><code>#define BACKWARD_HAS_DW 1
</code></pre></div>
<p dir="auto">Of course you can simply add the define (<code>-DBACKWARD_HAS_...=1</code>) and the
linkage details in your build system and even auto-detect which library is
installed, it's up to you.</p>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto"><a href="https://sourceforge.net/projects/libdwarf/" rel="nofollow">libdwarf</a> and <a href="http://www.mr511.de/software/english.html" rel="nofollow">libelf</a></h4><a id="user-content-libdwarf-and-libelf" class="anchor" aria-label="Permalink: libdwarf and libelf" href="#libdwarf-and-libelf"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="apt-get install libdwarf-dev (or equivalent)"><pre class="notranslate"><code>apt-get install libdwarf-dev (or equivalent)
</code></pre></div>
<p dir="auto">And do not forget to link with the lib and inform Backward to use it:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="#define BACKWARD_HAS_DWARF 1"><pre class="notranslate"><code>#define BACKWARD_HAS_DWARF 1
</code></pre></div>
<p dir="auto">There are several alternative implementations of libdwarf and libelf that
are API compatible so it's possible, although it hasn't been tested, to
replace the ones used when developing backward (in bold, below):</p>
<ul dir="auto">
<li><strong><em>libelf</em></strong> by <a href="http://www.mr511.de/software/english.html" rel="nofollow">Michael "Tired" Riepe</a></li>
<li><strong><em>libdwarf</em></strong> by <a href="https://www.prevanders.net/dwarf.html" rel="nofollow">David Anderson</a></li>
<li>libelf from <a href="https://fedorahosted.org/elfutils/" rel="nofollow">elfutils</a></li>
<li>libelf and libdwarf from FreeBSD's <a href="https://sourceforge.net/p/elftoolchain/wiki/Home/" rel="nofollow">ELF Tool Chain</a> project</li>
</ul>
<p dir="auto">Of course you can simply add the define (<code>-DBACKWARD_HAS_...=1</code>) and the
linkage details in your build system and even auto-detect which library is
installed, it's up to you.</p>
<p dir="auto">That's it, you are all set, you should be getting nice stack traces like the
one at the beginning of this document.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">API</h2><a id="user-content-api" class="anchor" aria-label="Permalink: API" href="#api"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">If you don't want to limit yourself to the defaults offered by <code>backward.cpp</code>,
and you want to take some random stack traces for whatever reason and pretty
print them the way you love or you decide to send them all to your buddies over
the Internet, you will appreciate the simplicity of Backward's API.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Stacktrace</h3><a id="user-content-stacktrace" class="anchor" aria-label="Permalink: Stacktrace" href="#stacktrace"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The StackTrace class lets you take a "snapshot" of the current stack.
You can use it like this:</p>
<div class="highlight highlight-source-c++ notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using namespace backward;
StackTrace st; st.load_here(32);
Printer p; p.print(st);"><pre><span class="pl-k">using</span> <span class="pl-k">namespace</span> <span class="pl-en">backward</span><span class="pl-k">;</span>
StackTrace st; st.load_here(<span class="pl-c1">32</span>);
Printer p; p.print(st);</pre></div>
<p dir="auto">The public methods are:</p>
<div class="highlight highlight-source-c++ notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="class StackTrace { public:
	// Take a snapshot of the current stack, with at most &quot;trace_cnt_max&quot;
	// traces in it. The first trace is the most recent (ie the current
	// frame). You can also provide a trace address to load_from() assuming
	// the address is a valid stack frame (useful for signal handling traces).
	// Both function return size().
	size_t load_here(size_t trace_cnt_max)
	size_t load_from(void* address, size_t trace_cnt_max)

	// The number of traces loaded. This can be less than &quot;trace_cnt_max&quot;.
	size_t size() const

	// A unique id for the thread in which the trace was taken. The value
	// 0 means the stack trace comes from the main thread.
	size_t thread_id() const

	// Retrieve a trace by index. 0 is the most recent trace, size()-1 is
	// the oldest one.
	Trace operator[](size_t trace_idx)
};"><pre><span class="pl-k">class</span> <span class="pl-en">StackTrace</span> { <span class="pl-k">public:</span>
	<span class="pl-c"><span class="pl-c">//</span> Take a snapshot of the current stack, with at most "trace_cnt_max"</span>
	<span class="pl-c"><span class="pl-c">//</span> traces in it. The first trace is the most recent (ie the current</span>
	<span class="pl-c"><span class="pl-c">//</span> frame). You can also provide a trace address to load_from() assuming</span>
	<span class="pl-c"><span class="pl-c">//</span> the address is a valid stack frame (useful for signal handling traces).</span>
	<span class="pl-c"><span class="pl-c">//</span> Both function return size().</span>
	<span class="pl-c1">size_t</span> <span class="pl-en">load_here</span>(<span class="pl-c1">size_t</span> trace_cnt_max)
	size_t load_from(<span class="pl-k">void</span>* address, <span class="pl-c1">size_t</span> trace_cnt_max)

	<span class="pl-c"><span class="pl-c">//</span> The number of traces loaded. This can be less than "trace_cnt_max".</span>
	size_t size() <span class="pl-k">const</span>

	<span class="pl-c"><span class="pl-c">//</span> A unique id for the thread in which the trace was taken. The value</span>
	<span class="pl-c"><span class="pl-c">//</span> 0 means the stack trace comes from the main thread.</span>
	size_t thread_id() <span class="pl-k">const</span>

	<span class="pl-c"><span class="pl-c">//</span> Retrieve a trace by index. 0 is the most recent trace, size()-1 is</span>
	<span class="pl-c"><span class="pl-c">//</span> the oldest one.</span>
	Trace operator[](<span class="pl-c1">size_t</span> trace_idx)
};</pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">TraceResolver</h3><a id="user-content-traceresolver" class="anchor" aria-label="Permalink: TraceResolver" href="#traceresolver"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The <code>TraceResolver</code> does the heavy lifting, and intends to transform a simple
<code>Trace</code> from its address into a fully detailed <code>ResolvedTrace</code> with the
filename of the source, line numbers, inlined functions and so on.</p>
<p dir="auto">You can use it like this:</p>
<div class="highlight highlight-source-c++ notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using namespace backward;
StackTrace st; st.load_here(32);

TraceResolver tr; tr.load_stacktrace(st);
for (size_t i = 0; i &lt; st.size(); ++i) {
	ResolvedTrace trace = tr.resolve(st[i]);
	std::cout &lt;&lt; &quot;#&quot; &lt;&lt; i
		&lt;&lt; &quot; &quot; &lt;&lt; trace.object_filename
		&lt;&lt; &quot; &quot; &lt;&lt; trace.object_function
		&lt;&lt; &quot; [&quot; &lt;&lt; trace.addr &lt;&lt; &quot;]&quot;
	&lt;&lt; std::endl;
}"><pre><span class="pl-k">using</span> <span class="pl-k">namespace</span> <span class="pl-en">backward</span><span class="pl-k">;</span>
StackTrace st; st.load_here(<span class="pl-c1">32</span>);

TraceResolver tr; tr.load_stacktrace(st);
<span class="pl-k">for</span> (<span class="pl-c1">size_t</span> i = <span class="pl-c1">0</span>; i &lt; st.size(); ++i) {
	ResolvedTrace trace = tr.<span class="pl-c1">resolve</span>(st[i]);
	std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>#<span class="pl-pds">"</span></span> &lt;&lt; i
		&lt;&lt; <span class="pl-s"><span class="pl-pds">"</span> <span class="pl-pds">"</span></span> &lt;&lt; trace.<span class="pl-smi">object_filename</span>
		&lt;&lt; <span class="pl-s"><span class="pl-pds">"</span> <span class="pl-pds">"</span></span> &lt;&lt; trace.<span class="pl-smi">object_function</span>
		&lt;&lt; <span class="pl-s"><span class="pl-pds">"</span> [<span class="pl-pds">"</span></span> &lt;&lt; trace.<span class="pl-smi">addr</span> &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>]<span class="pl-pds">"</span></span>
	&lt;&lt; std::endl;
}</pre></div>
<p dir="auto">The public methods are:</p>
<div class="highlight highlight-source-c++ notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="class TraceResolver { public:
	// Pre-load whatever is necessary from the stack trace.
	template &lt;class ST&gt;
		void load_stacktrace(ST&amp;)

	// Resolve a trace. It takes a ResolvedTrace, because a `Trace` is
	// implicitly convertible to it.
	ResolvedTrace resolve(ResolvedTrace t)
};"><pre><span class="pl-k">class</span> <span class="pl-en">TraceResolver</span> { <span class="pl-k">public:</span>
	<span class="pl-c"><span class="pl-c">//</span> Pre-load whatever is necessary from the stack trace.</span>
	<span class="pl-k">template </span>&lt;<span class="pl-k">class</span> <span class="pl-en">ST</span>&gt;
		<span class="pl-k">void</span> <span class="pl-en">load_stacktrace</span>(ST&amp;)

	<span class="pl-c"><span class="pl-c">//</span> Resolve a trace. It takes a ResolvedTrace, because a `Trace` is</span>
	<span class="pl-c"><span class="pl-c">//</span> implicitly convertible to it.</span>
	ResolvedTrace resolve(ResolvedTrace t)
};</pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">SnippetFactory</h3><a id="user-content-snippetfactory" class="anchor" aria-label="Permalink: SnippetFactory" href="#snippetfactory"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The SnippetFactory is a simple helper class to automatically load and cache
source files in order to extract code snippets.</p>
<div class="highlight highlight-source-c++ notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="class SnippetFactory { public:
	// A snippet is a list of line numbers and line contents.
	typedef std::vector&lt;std::pair&lt;size_t, std::string&gt; &gt; lines_t;

	// Return a snippet starting at line_start with up to context_size lines.
	lines_t get_snippet(const std::string&amp; filename,
			size_t line_start, size_t context_size)

	// Return a combined snippet from two different locations and combine them.
	// context_size / 2 lines will be extracted from each location.
	lines_t get_combined_snippet(
			const std::string&amp; filename_a, size_t line_a,
			const std::string&amp; filename_b, size_t line_b,
			size_t context_size)

	// Tries to return a unified snippet if the two locations from the same
	// file are close enough to fit inside one context_size, else returns
	// the equivalent of get_combined_snippet().
	lines_t get_coalesced_snippet(const std::string&amp; filename,
			size_t line_a, size_t line_b, size_t context_size)"><pre><span class="pl-k">class</span> <span class="pl-en">SnippetFactory</span> { <span class="pl-k">public:</span>
	<span class="pl-c"><span class="pl-c">//</span> A snippet is a list of line numbers and line contents.</span>
	<span class="pl-k">typedef</span> std::vector&lt;std::pair&lt;<span class="pl-c1">size_t</span>, std::string&gt; &gt; <span class="pl-c1">lines_t</span>;

	<span class="pl-c"><span class="pl-c">//</span> Return a snippet starting at line_start with up to context_size lines.</span>
	<span class="pl-c1">lines_t</span> <span class="pl-en">get_snippet</span>(<span class="pl-k">const</span> std::string&amp; filename,
			<span class="pl-c1">size_t</span> line_start, <span class="pl-c1">size_t</span> context_size)

	<span class="pl-c"><span class="pl-c">//</span> Return a combined snippet from two different locations and combine them.</span>
	<span class="pl-c"><span class="pl-c">//</span> context_size / 2 lines will be extracted from each location.</span>
	lines_t get_combined_snippet(
			<span class="pl-k">const</span> std::string&amp; filename_a, <span class="pl-c1">size_t</span> line_a,
			<span class="pl-k">const</span> std::string&amp; filename_b, <span class="pl-c1">size_t</span> line_b,
			<span class="pl-c1">size_t</span> context_size)

	<span class="pl-c"><span class="pl-c">//</span> Tries to return a unified snippet if the two locations from the same</span>
	<span class="pl-c"><span class="pl-c">//</span> file are close enough to fit inside one context_size, else returns</span>
	<span class="pl-c"><span class="pl-c">//</span> the equivalent of get_combined_snippet().</span>
	lines_t get_coalesced_snippet(<span class="pl-k">const</span> std::string&amp; filename,
			<span class="pl-c1">size_t</span> line_a, <span class="pl-c1">size_t</span> line_b, <span class="pl-c1">size_t</span> context_size)</pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Printer</h3><a id="user-content-printer" class="anchor" aria-label="Permalink: Printer" href="#printer"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">A simpler way to pretty print a stack trace to the terminal. It will
automatically resolve the traces for you:</p>
<div class="highlight highlight-source-c++ notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using namespace backward;
StackTrace st; st.load_here(32);
Printer p;
p.object = true;
p.color_mode = ColorMode::always;
p.address = true;
p.print(st, stderr);"><pre><span class="pl-k">using</span> <span class="pl-k">namespace</span> <span class="pl-en">backward</span><span class="pl-k">;</span>
StackTrace st; st.load_here(<span class="pl-c1">32</span>);
Printer p;
p.object = <span class="pl-c1">true</span>;
p.color_mode = ColorMode::always;
p.address = <span class="pl-c1">true</span>;
p.print(st, stderr);</pre></div>
<p dir="auto">You can set a few options:</p>
<div class="highlight highlight-source-c++ notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="class Printer { public:
	// Print a little snippet of code if possible.
	bool snippet = true;

	// Colorize the trace
	//  - ColorMode::automatic: Activate colors if possible. For example, when using a TTY on linux.
	//  - ColorMode::always: Always use colors.
	//  - ColorMode::never: Never use colors.
	bool color_mode = ColorMode::automatic;

	// Add the addresses of every source location to the trace.
	bool address = false;

	// Even if there is a source location, also prints the object
	// from where the trace came from.
	bool object = false;

	// Resolve and print a stack trace to the given C FILE* object.
	// On linux, if the FILE* object is attached to a TTY,
	// color will be used if color_mode is set to automatic.
	template &lt;typename StackTrace&gt;
		FILE* print(StackTrace&amp; st, FILE* fp = stderr);

	// Resolve and print a stack trace to the given std::ostream object.
	// Color will only be used if color_mode is set to always. 
	template &lt;typename ST&gt;
		std::ostream&amp; print(ST&amp; st, std::ostream&amp; os);"><pre><span class="pl-k">class</span> <span class="pl-en">Printer</span> { <span class="pl-k">public:</span>
	<span class="pl-c"><span class="pl-c">//</span> Print a little snippet of code if possible.</span>
	<span class="pl-k">bool</span> snippet = <span class="pl-c1">true</span>;

	<span class="pl-c"><span class="pl-c">//</span> Colorize the trace</span>
	<span class="pl-c"><span class="pl-c">//</span>  - ColorMode::automatic: Activate colors if possible. For example, when using a TTY on linux.</span>
	<span class="pl-c"><span class="pl-c">//</span>  - ColorMode::always: Always use colors.</span>
	<span class="pl-c"><span class="pl-c">//</span>  - ColorMode::never: Never use colors.</span>
	<span class="pl-k">bool</span> color_mode = ColorMode::automatic;

	<span class="pl-c"><span class="pl-c">//</span> Add the addresses of every source location to the trace.</span>
	<span class="pl-k">bool</span> address = <span class="pl-c1">false</span>;

	<span class="pl-c"><span class="pl-c">//</span> Even if there is a source location, also prints the object</span>
	<span class="pl-c"><span class="pl-c">//</span> from where the trace came from.</span>
	<span class="pl-k">bool</span> object = <span class="pl-c1">false</span>;

	<span class="pl-c"><span class="pl-c">//</span> Resolve and print a stack trace to the given C FILE* object.</span>
	<span class="pl-c"><span class="pl-c">//</span> On linux, if the FILE* object is attached to a TTY,</span>
	<span class="pl-c"><span class="pl-c">//</span> color will be used if color_mode is set to automatic.</span>
	<span class="pl-k">template </span>&lt;<span class="pl-k">typename</span> StackTrace&gt;
		FILE* <span class="pl-en">print</span>(StackTrace&amp; st, FILE* fp = stderr);

	<span class="pl-c"><span class="pl-c">//</span> Resolve and print a stack trace to the given std::ostream object.</span>
	<span class="pl-c"><span class="pl-c">//</span> Color will only be used if color_mode is set to always. </span>
	<span class="pl-k">template </span>&lt;<span class="pl-k">typename</span> ST&gt;
		std::ostream&amp; <span class="pl-en">print</span>(ST&amp; st, std::ostream&amp; os);</pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">SignalHandling</h3><a id="user-content-signalhandling" class="anchor" aria-label="Permalink: SignalHandling" href="#signalhandling"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">A simple helper class that registers for you the most common signals and other
callbacks to segfault, hardware exception, un-handled exception etc.</p>
<p dir="auto"><code>backward.cpp</code> simply uses it like that:</p>
<div class="highlight highlight-source-c++ notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="backward::SignalHandling sh;"><pre>backward::SignalHandling sh;</pre></div>
<p dir="auto">Creating the object registers all the different signals and hooks. Destroying
this object doesn't do anything. It exposes only one method:</p>
<div class="highlight highlight-source-c++ notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="bool loaded() const // true if loaded with success"><pre><span class="pl-k">bool</span> <span class="pl-en">loaded</span>() <span class="pl-k">const</span> <span class="pl-c"><span class="pl-c">//</span> true if loaded with success</span></pre></div>
<p dir="auto"><strong>Warning:</strong> The registered signal handlers are not
<a href="https://www.man7.org/linux/man-pages/man7/signal-safety.7.html" rel="nofollow">signal safe</a>,
mostly because backward-cpp and the DWARF decoding libraries are using <code>malloc</code>.
In case a signal is raised while malloc is holding a lock, a deadlock will
occur.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Trace object</h3><a id="user-content-trace-object" class="anchor" aria-label="Permalink: Trace object" href="#trace-object"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">To keep the memory footprint of a loaded <code>StackTrace</code> on the low-side, there a
hierarchy of trace object, from a minimal <code>Trace </code>to a <code>ResolvedTrace</code>.</p>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Simple trace</h4><a id="user-content-simple-trace" class="anchor" aria-label="Permalink: Simple trace" href="#simple-trace"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="highlight highlight-source-c++ notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="struct Trace {
	void*  addr; // address of the trace
	size_t idx;  // its index (0 == most recent)
};"><pre><span class="pl-k">struct</span> <span class="pl-en">Trace</span> {
	<span class="pl-k">void</span>*  addr; <span class="pl-c"><span class="pl-c">//</span> address of the trace</span>
	<span class="pl-c1">size_t</span> idx;  <span class="pl-c"><span class="pl-c">//</span> its index (0 == most recent)</span>
};</pre></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Resolved trace</h4><a id="user-content-resolved-trace" class="anchor" aria-label="Permalink: Resolved trace" href="#resolved-trace"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">A <code>ResolvedTrace</code> should contains a maximum of details about the location of
the trace in the source code. Note that not all fields might be set.</p>
<div class="highlight highlight-source-c++ notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="struct ResolvedTrace: public Trace {

	struct SourceLoc {
		std::string function;
		std::string filename;
		unsigned    line;
		unsigned    col;
	};

	// In which binary object this trace is located.
	std::string                    object_filename;

	// The function in the object that contains the trace. This is not the same
	// as source.function which can be an function inlined in object_function.
	std::string                    object_function;

	// The source location of this trace. It is possible for filename to be
	// empty and for line/col to be invalid (value 0) if this information
	// couldn't be deduced, for example if there is no debug information in the
	// binary object.
	SourceLoc                      source;

	// An optional list of &quot;inliners&quot;. All of these sources locations where
	// inlined in the source location of the trace (the attribute right above).
	// This is especially useful when you compile with optimizations turned on.
	typedef std::vector&lt;SourceLoc&gt; source_locs_t;
	source_locs_t                  inliners;
};"><pre><span class="pl-k">struct</span> <span class="pl-en">ResolvedTrace</span>: <span class="pl-k">public</span> <span class="pl-en">Trace</span> {

	<span class="pl-k">struct</span> <span class="pl-en">SourceLoc</span> {
		std::string function;
		std::string filename;
		<span class="pl-k">unsigned</span>    line;
		<span class="pl-k">unsigned</span>    col;
	};

	<span class="pl-c"><span class="pl-c">//</span> In which binary object this trace is located.</span>
	std::string                    object_filename;

	<span class="pl-c"><span class="pl-c">//</span> The function in the object that contains the trace. This is not the same</span>
	<span class="pl-c"><span class="pl-c">//</span> as source.function which can be an function inlined in object_function.</span>
	std::string                    object_function;

	<span class="pl-c"><span class="pl-c">//</span> The source location of this trace. It is possible for filename to be</span>
	<span class="pl-c"><span class="pl-c">//</span> empty and for line/col to be invalid (value 0) if this information</span>
	<span class="pl-c"><span class="pl-c">//</span> couldn't be deduced, for example if there is no debug information in the</span>
	<span class="pl-c"><span class="pl-c">//</span> binary object.</span>
	SourceLoc                      source;

	<span class="pl-c"><span class="pl-c">//</span> An optional list of "inliners". All of these sources locations where</span>
	<span class="pl-c"><span class="pl-c">//</span> inlined in the source location of the trace (the attribute right above).</span>
	<span class="pl-c"><span class="pl-c">//</span> This is especially useful when you compile with optimizations turned on.</span>
	<span class="pl-k">typedef</span> std::vector&lt;SourceLoc&gt; <span class="pl-c1">source_locs_t</span>;
	<span class="pl-c1">source_locs_t</span>                  inliners;
};</pre></div>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Contact and copyright</h2><a id="user-content-contact-and-copyright" class="anchor" aria-label="Permalink: Contact and copyright" href="#contact-and-copyright"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">François-Xavier Bourlet <a href="mailto:bombela@gmail.com">bombela@gmail.com</a></p>
<p dir="auto">Copyright 2013-2017 Google Inc. All Rights Reserved.
MIT License.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Disclaimer</h3><a id="user-content-disclaimer" class="anchor" aria-label="Permalink: Disclaimer" href="#disclaimer"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Although this project is owned by Google Inc. this is not a Google supported or
affiliated project.</p>
</article></div>